(function(api){var ComponentAdminBar=api.ComponentAdminBar=api.extendReactClass('MixinBase',{getInitialState:function(){return{favorites:false,history:false};},componentWillMount:function(){this.parent();document.body.classList.add('pa-adminbar');api.Event.add(document,'click',function(event){var target=event.target;while(target&&target.nodeName!='BODY'){if(target.getAttribute('data-dismiss')=='modal'){break;}target=target.parentNode;}if(!target||target.nodeName=='BODY'){return;}setTimeout(function(){var backdrop=document.querySelector('.modal-backdrop');if(backdrop){backdrop.parentNode.removeChild(backdrop);}},100);});},render:function(){return React.createElement('div',{ref:'mountedDOMNode',className:'container-fluid'},this.config?React.createElement('nav',{className:'navbar navbar-expand-lg pa-nav r p-0'},React.createElement('a',{href:this.config.brand.link,title:this.config.brand.slogan,target:this.config.brand.target,className:'pa-logo'},React.createElement('img',{src:this.config.brand.logo})),React.createElement('button',{type:'button',className:'navbar-toggler','data-toggle':'collapse','data-target':'#navbarSupportedContent','aria-controls':'navbarSupportedContent','aria-expanded':'false','aria-label':'Toggle navigation'},React.createElement('span',{className:'navbar-toggler-icon'})),React.createElement('div',{className:'collapse navbar-collapse'},React.createElement(api.ElementMenu,{type:'navbar',items:this.config.left,className:'ml-0',container:this}),React.createElement(api.ElementMenu,{type:'navbar',items:this.config.right,className:'navbar-right pa-plugins d-flex align-items-center ml-auto',container:this}))):null);},componentDidMount:function(){this.parent();api.Event.add(window,'resize',this.calculateMaxHeight);},componentDidUpdate:function(){this.parent();if(this.config){this.calculateMaxHeight();if(!this.dropdownSubmenuToggles){this.dropdownSubmenuToggles=this.refs.mountedDOMNode.querySelectorAll('.navbar-nav>.dropdown>.dropdown-menu>.dropdown-submenu');this.dropdownSubmenus=this.refs.mountedDOMNode.querySelectorAll('.navbar-nav>.dropdown>.dropdown-menu>.dropdown-submenu>.dropdown-menu');api.Event.add(this.dropdownSubmenuToggles,'mouseover',this.showSubmenu);api.Event.add(this.dropdownSubmenuToggles,'mouseout',this.hideSubmenu);api.Event.add(this.dropdownSubmenus,'mouseout',this.hideSubmenu);api.Event.add(document,'click',this.handleClick);}var previewLink=this.refs.mountedDOMNode.querySelector('.pa-preview-site>a');if(previewLink&&!previewLink.getAttribute('data-href')){previewLink.setAttribute('data-href',previewLink.href);api.Event.add(previewLink,'click',function(event){for(var test in this.config.editToPreviewLinkMapping){if(window.location.href.match(new RegExp(test))){previewLink.href=window.location.href.replace(new RegExp(test),this.config.editToPreviewLinkMapping[test]);if(previewLink.href.indexOf('/administrator/')>-1){previewLink.href=previewLink.href.replace('/administrator/','/');}return;}}previewLink.href=previewLink.getAttribute('data-href');}.bind(this));}}},componentWillUnmount:function(){this.parent();api.Event.remove(window,'resize',this.calculateMaxHeight);if(this.dropdownSubmenuToggles){api.Event.remove(this.dropdownSubmenuToggles,'mouseover',this.showSubmenu);api.Event.remove(this.dropdownSubmenuToggles,'mouseout',this.hideSubmenu);api.Event.remove(this.dropdownSubmenus,'mouseout',this.hideSubmenu);api.Event.remove(document,'click',this.handleClick);}},calculateMaxHeight:function(){this.calculateMaxHeightTimer&&clearTimeout(this.calculateMaxHeightTimer);this.calculateMaxHeightTimer=setTimeout(function(){if(this.refs.mountedDOMNode){var adminBarHeight=this.refs.mountedDOMNode.getBoundingClientRect().height,statusBar=document.querySelector('#status'),statusHeight=statusBar?statusBar.getBoundingClientRect().height:0,clientHeight=(document.documentElement||document.body).clientHeight,maxHeight=clientHeight-adminBarHeight-statusHeight,styleNode=document.querySelector('#pa-adminbar-styles');if(!styleNode){styleNode=document.createElement('style');styleNode.id='pa-adminbar-styles';styleNode.type='text/css';styleNode.textContent="\n"+"#pa-adminbar .navbar-nav>.open>.dropdown-menu{\n"+"\toverflow-x:hidden;overflow-y:auto;\n"+"}\n"+"#pa-adminbar .navbar-nav>.open>.dropdown-menu>.dropdown-submenu:hover>.dropdown-menu{\n"+"\tdisplay:none!important;\n"+"}\n";document.head.appendChild(styleNode);}styleNode.textContent+=''+'#pa-adminbar .navbar-nav>.open>.dropdown-menu{max-height:'+maxHeight+"px;}\n";}}.bind(this),500);},showSubmenu:function(event){var target=event.target;while(target&&!target.classList.contains('dropdown-submenu')&&target.nodeName!='BODY'){target=target.parentNode;}if(!target||target.nodeName=='BODY'){return;}this.hideVisibleSubmenu(target);if(!target.subMenu){var container=document.getElementById('pa-adminbar-submenus');if(!container){container=document.createElement('div');container.id='pa-adminbar-submenus';container.className=this.config.wrapperClass;document.body.appendChild(container);}target.subMenu=target.querySelector('.dropdown-menu');target.subMenu.parentItem=target;target.subMenu.style.position='fixed';target.subMenu.style.display='none';target.subMenu.style.zIndex='1050';container.appendChild(target.subMenu);}target.subMenu.style.display='initial';target.subMenu.style.visibility='hidden';var rect=target.getBoundingClientRect(),subStyle=window.getComputedStyle(target.subMenu),marginTop=parseInt(subStyle.getPropertyValue('margin-top')),borderTop=parseInt(subStyle.getPropertyValue('border-top-width')),paddingTop=parseInt(subStyle.getPropertyValue('padding-top'));target.subMenu.style.top=rect.top-marginTop-borderTop-paddingTop+'px';target.subMenu.style.left=rect.left+rect.width+'px';var subRect=target.subMenu.getBoundingClientRect(),clientHeight=(document.documentElement||document.body).clientHeight;if(subRect.top+subRect.height>clientHeight){var containerRect=target.parentNode.getBoundingClientRect();target.subMenu.style.top=containerRect.height-subRect.height+containerRect.top-marginTop+'px';}target.subMenu.style.visibility='visible';},hideSubmenu:function(event){var src=event.target;while(src&&src.nodeName!='BODY'){if(src.classList&&(src.classList.contains('dropdown-submenu')||src.classList.contains('dropdown-menu'))){break;}src=src.parentNode;}if(src.classList&&src.classList.contains('dropdown-menu')){src=src.parentItem;}if(!src||!src.subMenu||src.nodeName=='BODY'){return;}var dest=event.relatedTarget;while(dest&&dest.nodeName!='BODY'){if(dest==src.subMenu){break;}dest=dest.parentNode;}if(dest&&dest.nodeName=='BODY'){src.subMenu.style.display='none';}},hideVisibleSubmenu:function(active){for(var i=0;i<this.dropdownSubmenuToggles.length;i++){if(active&&this.dropdownSubmenus[i]==active){continue;}if(this.dropdownSubmenus[i].style.display=='initial'){this.dropdownSubmenus[i].style.display='none';break;}}},handleClick:function(event){var target=event.target,found=false;while(target&&target.nodeName!='BODY'){for(var i=0;i<this.dropdownSubmenus.length;i++){if(target==this.dropdownSubmenus[i]){found=true;}}if(found){break;}target=target.parentNode;}if(!found){this.hideVisibleSubmenu();}},getFavorites:function(event){event.preventDefault();if(this.state.favorites){return;}var item=event.target;while(item&&item.nodeName!='LI'&&item.nodeName!='BODY'){item=item.parentNode;}if(item.nodeName=='BODY'){return;}var menu=item.querySelector('ul');var component=api.findReactComponent(menu);if(!component){return;}var items=component.state.items.concat([{title:React.createElement(api.ElementLoading,{inline:true,size:'1x'}),className:'text-center'}]);component.setState({items:items});api.Ajax.request(item.firstElementChild.href,function(res){if(res.responseJSON&&res.responseJSON.success&&res.responseJSON.favorites.length){var favorites=[];for(var i=0;i<res.responseJSON.favorites.length;i++){var favorite=res.responseJSON.favorites[i];favorite.className='favorite-entry';favorite.description=React.createElement('a',{href:'javascript:void(0)',onClick:this.removeFavorite.bind(this,favorite.id),className:'remove-favorite float-right'},React.createElement('i',{className:'fa fa-trash'}));favorites.push(favorite);}var items=component.state.items.slice(0,-1).concat(favorites);}else{var items=component.state.items;items[items.length-1].title=api.Text.parse('not-found-any-favorite');}component.setState({items:items});this.state.favorites=true;}.bind(this));},addFavorite:function(event){event.preventDefault();var item=event.target;while(item&&item.nodeName!='A'&&item.nodeName!='BODY'){item=item.parentNode;}if(item.nodeName=='BODY'){return;}item.parentNode.parentNode.parentNode.click();var link=window.location.href,title=document.title.split('-')[0];var modal=api.Modal.get({type:'html',title:api.Text.parse('add-current-page-to-favorite'),content:React.createElement('div',null,React.createElement('div',{key:api.Text.toId('page_title_',true),className:'form-group'},React.createElement('label',null,api.Text.parse('page-title')),React.createElement(api.ElementInput,{type:'text',name:'page_title',value:title,className:'form-control'})),React.createElement('div',{key:api.Text.toId('page_link_',true),className:'form-group'},React.createElement('label',null,api.Text.parse('page-url')),React.createElement(api.ElementInput,{type:'text',name:'page_link',value:link,className:'form-control'}))),width:'66%',height:0,centralize:false,onModalShown:function(event){var input=event.target.refs.mountedDOMNode.querySelector('input');if(input){input.focus();}},confirm:function(modal){modal.close();var favorite={link:modal.refs.mountedDOMNode.querySelector('input[name="page_link"]').value,title:modal.refs.mountedDOMNode.querySelector('input[name="page_title"]').value};this.executeAction({link:item.href,ajax:true,callback:function(type,res,event){if(type=='prepare'){return res;}var component=api.findReactComponent(item);if(component){favorite.id=res.responseJSON.id;favorite.className='favorite-entry';favorite.description=React.createElement('a',{href:'javascript:void(0)',onClick:this.removeFavorite.bind(this,res.responseJSON.id),className:'remove-favorite float-right'},React.createElement('i',{className:'fa fa-trash'}));var items=component.state.items;if(items[items.length-1].title==api.Text.parse('not-found-any-favorite')){items=items.slice(0,-1).concat([favorite]);}else{items=items.concat([favorite]);}component.setState({items:items});}return true;}.bind(this)},favorite,item.parentNode,event);}.bind(this)});},removeFavorite:function(id,event){var item=event.target;while(item&&item.nodeName!='A'&&item.nodeName!='BODY'){item=item.parentNode;}if(item.nodeName=='BODY'){return;}item.firstElementChild.origClass=item.firstElementChild.className;item.firstElementChild.className='fa fa-circle-o-notch fa-spin';api.Ajax.request(this.config.actions.removeFavorite.link.replace('{id}',id),function(res){item.firstElementChild.className=item.firstElementChild.origClass;if(res.responseJSON&&res.responseJSON.success){var component=api.findReactComponent(item);if(component){var items=component.state.items;for(var i=0;i<items.length;i++){if(items[i].id==id){items.splice(i,1);break;}}component.setState({items:items});}}else{item.parentNode.parentNode.parentNode.click();api.Modal.alert(res.responseJSON?res.responseJSON.message:res.responseText);}}.bind(this));},getHistory:function(event){event.preventDefault();if(this.state.history){return;}var item=event.target;while(item&&item.nodeName!='LI'&&item.nodeName!='BODY'){item=item.parentNode;}if(item.nodeName=='BODY'){return;}var menu=item.querySelector('ul');var component=api.findReactComponent(menu);if(!component){return;}component.setState({items:[{title:React.createElement(api.ElementLoading,{inline:true,size:'1x'}),className:'text-center'}]});api.Ajax.request(item.firstElementChild.href,function(res){var items;if(res.responseJSON&&res.responseJSON.success&&res.responseJSON.activities.length){items=res.responseJSON.activities;}else{items=[{title:api.Text.parse('not-found-any-activity'),className:'text-center'}];}component.setState({items:items});this.state.history=true;}.bind(this));},initSpotlightSearch:function(type,item,elm){if(this.spotlightSearchInput){return;}var icon=elm.firstElementChild.firstElementChild;ReactDOM.render(React.createElement(api.ElementInput,{type:'text',placeholder:item.placeholder}),elm.firstElementChild);elm.firstElementChild.insertBefore(icon,elm.firstElementChild.firstElementChild);var menu=elm.querySelector('ul');var component=api.findReactComponent(menu);if(!component){return;}api.Text.setData(null,false,component);api.Text.components.splice(api.Text.components.indexOf(this),1);api.Event.add(elm.firstElementChild,'click',function(event){event.preventDefault();if(!component.state.items.length){component.setState({items:[{title:api.Text.parse('spotlight-search-hint'),className:'text-center'}]});}});this.spotlightSearchInput=elm.querySelector('input');api.Event.add(this.spotlightSearchInput,'keyup',function(event){if(event.target.value.length<3){return component.setState({items:[{title:api.Text.parse('spotlight-search-hint'),className:'text-center'}]});}component.setState({items:[{title:React.createElement(api.ElementLoading,{inline:true,size:'1x'}),className:'text-center'}]});api.Ajax.request(event.target.parentNode.href+'&keyword='+encodeURIComponent(event.target.value),function(res){var items;if(res.responseJSON&&res.responseJSON.success&&res.responseJSON.data.length){items=res.responseJSON.data;var pattern=new RegExp('('+event.target.value+')','i');for(var i=0;i<items.length;i++){if(items[i].description){items[i].description=items[i].description.replace(pattern,'<span class="highlight">$1</span>');}else{items[i].title=items[i].title.replace(pattern,'<span class="highlight">$1</span>');}}}else{items=[{title:api.Text.parse('not-found-any-result'),className:'text-center'}];}component.setState({items:items});}.bind(this));}.bind(this));},initSessionExpiration:function(type,item,elm){if(this.sessionCountDown){return;}var h=Math.floor(item.sessionExpiration/60),m=item.sessionExpiration%60,s=0;var hh=document.createElement('span'),mm=document.createElement('span'),ss=document.createElement('span');hh.className='count-down-hour';hh.textContent=h<10?'0'+h:h;mm.className='count-down-minute';mm.textContent=m<10?'0'+m:m;ss.className='count-down-second';ss.textContent=s<10?'0'+s:s;this.sessionCountDown=document.createElement('span');this.sessionCountDown.id='session-expiration-count-down';this.sessionCountDown.appendChild(hh);this.sessionCountDown.innerHTML+=':';this.sessionCountDown.appendChild(mm);this.sessionCountDown.innerHTML+=':';this.sessionCountDown.appendChild(ss);elm.firstElementChild.appendChild(this.sessionCountDown);(function countDownSessionTime(countDown){var hh=countDown.querySelector('.count-down-hour'),mm=countDown.querySelector('.count-down-minute'),ss=countDown.querySelector('.count-down-second');var h=parseInt(hh.textContent),m=parseInt(mm.textContent),s=parseInt(ss.textContent);if(s>0){s--;}else{s=59;if(m>0){m--;}else{m=59;if(h>0){h--;}}}hh.textContent=h<10?'0'+h:h;mm.textContent=m<10?'0'+m:m;ss.textContent=s<10?'0'+s:s;var icon=elm.parentNode.parentNode.querySelector('.fa');if(icon){var life=icon.parentNode.querySelector('.user-life');if(life){if(h==0&&m==0&&s==0){life.children[0].className=life.children[0].className.replace(/\bfa-[^\s]+\b/,'fa-ban');life.style.height='initial';life.children[0].style.top='initial';icon.style.display='none';return;}else{var height=Math.round((h * 3600+m * 60+s)/(item.sessionExpiration * 60)* 100/100 * icon.offsetHeight);life.style.height=height+'px';life.children[0].style.top=height-icon.offsetHeight+'px';}}}if(item.warnBeforeSessionTimeout&&!countDown.warnedAboutSessionTimeout&&h * 3600+m * 60+s<=item.warnBeforeSessionTimeout * 60){setTimeout(function(){alert(api.Text.parse('working-session-is-being-expired').replace(/%d|%\d\$d/g,item.warnBeforeSessionTimeout));},10);countDown.warnedAboutSessionTimeout=true;}setTimeout(countDownSessionTime.bind(this,countDown),1000);})(this.sessionCountDown);},uninstallComponent:function(){if(arguments.length==5){if(arguments[4]instanceof Node){var item=arguments[4];while(item.previousElementSibling){item=item.previousElementSibling;if(item.href&&(this.uninstalled=item.href.match(/[\?&]option=([^&]+)/))){break;}}if(!this.uninstalled&&item.parentNode.parentItem){if(item.parentNode.parentItem.firstElementChild.href){this.uninstalled=item.parentNode.parentItem.firstElementChild.href.match(/[\?&]option=([^&]+)/);}}}}else if(arguments.length==1&&this.uninstalled){if(window.location.href.indexOf('option='+this.uninstalled[1])>-1){window.location.href=window.location.href.split('?')[0];}}}});var ComponentCustomAssets=api.ComponentCustomAssets=api.extendReactClass('MixinBase',{getInitialState:function(){return{values:{css:{assets:{},legacy:0},js:{assets:{},legacy:0}},checked:{}};},render:function(){var cssFiles=[];if(this.state.values.css.assets instanceof Array){this.state.values.css.assets={};}for(var file in this.state.values.css.assets){cssFiles.push(this.renderFile('css',file));}var jsFiles=[];if(this.state.values.js.assets instanceof Array){this.state.values.js.assets={};}for(var file in this.state.values.js.assets){jsFiles.push(this.renderFile('js',file));}return React.createElement('form',{ref:'mountedDOMNode'},React.createElement('div',{className:'control-group'},React.createElement('div',{className:'control'},React.createElement('label',null,api.Text.parse('custom-css-files')),React.createElement('div',{className:'buttonbar'},React.createElement('button',{type:'button',className:'btn btn-default',onClick:this.addFile.bind(this,'css')},React.createElement('i',{className:'fa fa-plus'}),api.Text.parse('add')))),React.createElement('div',{className:'form-group'},React.createElement('div',{className:'form-control'},cssFiles.length?React.createElement('ul',{ref:'customCss',key:api.Text.toId('custom_css_',true),className:'item-list','data-type':'css'},cssFiles):null))),React.createElement('div',{className:'form-group'},React.createElement('div',{className:'checkbox'},React.createElement('label',{className:'form-check-label'},React.createElement('input',{type:'checkbox',checked:parseInt(this.state.values.css.legacy),onClick:this.enableLegacy.bind(this,'css'),className:'form-check-input'}),api.Text.parse('apply-custom-assets-for-children')))),React.createElement('hr',null),React.createElement('div',{className:'control-group'},React.createElement('div',{className:'control'},React.createElement('label',null,api.Text.parse('custom-js-files')),React.createElement('div',{className:'buttonbar'},React.createElement('button',{type:'button',className:'btn btn-default',onClick:this.addFile.bind(this,'js')},React.createElement('i',{className:'fa fa-plus'}),api.Text.parse('add')))),React.createElement('div',{className:'form-group'},React.createElement('div',{className:'form-control'},jsFiles.length?React.createElement('ul',{ref:'customJs',key:api.Text.toId('custom_js_',true),className:'item-list','data-type':'js'},jsFiles):null))),React.createElement('div',{className:'form-group'},React.createElement('div',{className:'checkbox'},React.createElement('label',{className:'form-check-label'},React.createElement('input',{type:'checkbox',checked:parseInt(this.state.values.js.legacy),onClick:this.enableLegacy.bind(this,'js'),className:'form-check-input'}),api.Text.parse('apply-custom-assets-for-children')))));},renderFile:function(type,file){var loaded=this.state.values[type].assets[file].loaded,disabled=this.state.checked.hasOwnProperty(file)&&this.state.checked[file]?false:true;loaded=parseInt(loaded)||loaded===true||loaded==='true'?true:false;return React.createElement('li',{className:'clearfix list-item'},React.createElement('i',{className:'fa fa-sort'}),React.createElement('input',{type:'checkbox',checked:loaded&&!disabled,disabled:disabled,onClick:this.loadFile.bind(this,type,file)}),React.createElement('span',{className:'custom-asset'},file,disabled?React.createElement('i',{className:'fa fa-exclamation-circle ml-2 hasTooltip',title:api.Text.parse('custom-asset-inaccessible')}):null),React.createElement('a',{href:'javascript:void(0)',className:'float-right',onClick:this.removeFile.bind(this,type,file)},React.createElement('i',{className:'fa fa-trash'})));},componentDidMount:function(){this.parent();this.initSortable();window.saveCustomAssets=this.save.bind(this);},componentWillUpdate:function(){this.deinitSortable();},componentDidUpdate:function(){this.parent();for(var type in this.state.values){for(var file in this.state.values[type].assets){if(!this.state.checked.hasOwnProperty(file)){var url=file;if(!url.match(/^(https*:)?\//)){url=this.config.site+'/'+file;}api.Ajax.request(url,function(type,file,res){var values=this.state.values,checked=this.state.checked;if(parseInt(res.status.toString().substr(0,1))!=2&&res.status!=304){checked[file]=false;}else{checked[file]=true;}if(values[type].assets[file].loaded&&!checked[file]){values[type].assets[file].loaded=0;}this.setState({values:values,checked:checked});}.bind(this,type,file));}}}if(jQuery!==undefined&&jQuery.fn.tooltip!==undefined){var hasTipElms=this.refs.mountedDOMNode.querySelectorAll('.hasTooltip');for(var i=0;i<hasTipElms.length;i++){try{jQuery(hasTipElms[i]).tooltip('destroy');}catch(e){}jQuery(hasTipElms[i]).tooltip({html:true,container:'body',placement:'right'});}}this.initSortable();},componentWillUnmount:function(){this.parent();this.deinitSortable();},initSortable:function(){for(var p in{customCss:'',customJs:''}){if(this.refs[p]){(this.sortable=this.sortable||{})[p]=sortable(this.refs[p],{items:'.list-item',handle:'.list-item .fa-sort',forcePlaceholderSize:true});api.Event.add(this.sortable[p][0],'sortupdate',this.handleSort);}}},deinitSortable:function(){if(this.sortable){for(var p in this.sortable){api.Event.remove(this.sortable[p][0],'sortupdate',this.handleSort);sortable(this.refs[p],'destroy');}delete this.sortable;}},handleSort:function(event){var type=event.detail.item.parentNode.getAttribute('data-type');var items=event.detail.item.parentNode.querySelectorAll('li');var values=JSON.parse(JSON.stringify(this.state.values));values[type].assets={};for(var i=0;i<items.length;i++){var file=items[i].querySelector('.custom-asset').textContent.trim();values[type].assets[file]={loaded:this.state.values[type].assets[file].loaded};}this.setState({values:values});},addFile:function(type){var modal=api.Modal.get({type:'html',title:api.Text.parse(type=='css'?'add-custom-css-file':'add-custom-js-file'),content:React.createElement('div',{key:api.Text.toId('add_asset_',true),className:'form-group'},React.createElement(api.ElementInput,{type:'text',name:'new_asset',value:'',className:'form-control',placeholder:api.Text.parse('custom-asset-input-hint')})),width:'66%',height:0,centralize:false,onModalShown:function(event){var input=event.target.refs.mountedDOMNode.querySelector('input');if(input){input.focus();}},confirm:function(type,modal){modal.close();var values=this.state.values;values[type].assets[modal.refs.mountedDOMNode.querySelector('input').value]={loaded:1};this.setState({values:values});}.bind(this,type)});},loadFile:function(type,file,event){var values=this.state.values;if(values[type].assets[file]){values[type].assets[file]={loaded:event.target.checked?1:0};}this.setState({values:values});},removeFile:function(type,file){var values=this.state.values;if(values[type].assets[file]){delete values[type].assets[file];}this.setState({values:values});},enableLegacy:function(type,event){var values=this.state.values;values[type].legacy=event.target.checked?1:0;this.setState({values:values});},save:function(callback){var post={data:JSON.stringify(this.state.values)};post[this.config.token]=1;api.Ajax.request(this.config.action,function(res){if(typeof callback=='function'){callback(res);}},post);}});var ComponentModuleAssignment=api.ComponentModuleAssignment=api.extendReactClass('MixinBase',{getDefaultProps:function(){return{fitHeight:'div.panel-body'};},render:function(){return React.createElement(api.PanelMenu,{ref:'menu',mode:'select'});},componentDidMount:function(){this.parent();window.saveModuleAssignment=this.save.bind(this);},componentDidUpdate:function(){this.parent();if(this.config&&!this.refs.menu.config){this.refs.menu.config=this.config;this.refs.menu.configDidLoad();var state={};if(!this.config.assigned.length){state.assignTo='no-page';}else{var assignTo=parseInt(this.config.assigned[0]);if(assignTo==0){state.assignTo='all-pages';}else if(assignTo<0){state.assignTo='all-except-selected-page';}else if(assignTo>0){state.assignTo='selected-page';}}if(['no-page','all-pages'].indexOf(state.assignTo)<0){state.checkedItems=this.config.assigned;}this.refs.menu.setState(state);}},save:function(callback){var post={assign_to:this.refs.menu.state.assignTo,menu_items:this.refs.menu.state.checkedItems};post[this.config.token]=1;api.Ajax.request(this.config.action,function(res){if(typeof callback=='function'){callback(res);}},post);}});var ComponentPagePreview=api.ComponentPagePreview=api.extendReactClass('MixinBase',{propTypes:{mode:React.PropTypes.string,config:React.PropTypes.string},getDefaultProps:function(){var mode='preview';if(window.location.href.indexOf('&select-position=1')>-1){mode='select';}else if(window.location.href.indexOf('&tmpl=component')>-1){mode='component';}return{mode:mode};},getInitialState:function(){if(this.props.mode=='select'){var selected=window.location.href.match(/[?&]selected=([^&]+)/);if(selected){selected=selected[1];}}return{selected:selected||null,loading:false};},componentWillMount:function(){this.parent();this.contextMenu=api.ContextMenu;if(window.parent){if(window.location.href.indexOf('&parent_id=')>-1){elm=window.parent.document.getElementById(window.location.href.split('&parent_id=')[1].split('&')[0]);}else{elm=window.parent.document.querySelector('#preview-panel');}if(elm){this.previewPanel=window.parent.findReactComponent(elm.querySelector('.card'));this.contextMenu=this.previewPanel.props.container.contextMenu;}}},configDidLoad:function(){if(window.parent){if(window.location.href.indexOf('&parent_id=')>-1){if(window.location.href.split('&parent_id=')[1].split('&')[0]=='component-panel'){if(!document.querySelector('.pa-component')&&!document.querySelector('[data-option]')){var div1=document.createElement('div');var div2=document.createElement('div');var ext=window.location.href.match(/[\?&]option=([^&]+)/)[1].substr(4).toUpperCase();div1.className='jsn-bootstrap4';div2.className='alert alert-warning';div2.innerHTML=api.Text.parse('unsupported-component',true).replace('%s',ext);div1.appendChild(div2);document.body.insertBefore(div1,document.body.firstElementChild);}}}}},render:function(){return this.state.loading?React.createElement(api.ElementLoading,null):React.createElement('div',{className:'pa-page-preview'});},componentDidMount:function(){api.Event.add(window,'load',function(){setTimeout(function(){var elms=document.body.children;for(var i=0;i<elms.length;i++){if(elms[i].id!='poweradmin-preview'){var clone=elms[i].cloneNode(true);document.body.replaceChild(clone,elms[i]);}}elms=document.querySelectorAll('*[onclick]');for(var i=0;i<elms.length;i++){elms[i].removeAttribute('onclick');}api.Event.add(document.body,'click',function(event){var target=event.target;while(target&&(!target.classList||!target.classList.contains('jsn-bootstrap4'))&&(!target.className||target.className.indexOf('menu')<0)&&target.nodeName!='BODY'){target=target.parentNode;}if(!target||target.className&&target.className.indexOf('menu')>-1||target.nodeName=='BODY'){event.preventDefault();if(target.className&&target.className.indexOf('menu')>-1){if(this.previewPanel.props.container.state.closedMenuPanel){this.previewPanel.props.container.toggleMenuPanel();}}}}.bind(this));var lastSheet=document.styleSheets[document.styleSheets.length-1];lastSheet.insertRule('li:hover ul{display:none!important;}',lastSheet.cssRules||lastSheet.rules?(lastSheet.cssRules||lastSheet.rules).length:0);lastSheet.insertRule('iframe{pointer-events:none!important;}',lastSheet.cssRules||lastSheet.rules?(lastSheet.cssRules||lastSheet.rules).length:0);var positions=document.querySelectorAll('.pa-position');for(var i=0;i<positions.length;i++){this.refs[positions[i].getAttribute('data-position')]=positions[i];}switch(this.props.mode){case 'preview':case 'component':api.Event.add(document,'click',this.toggleMenu);if(window.parent){api.Event.add(window.parent.document,'click',this.hideContextMenu);var oldOnBeforeUnload=window.onbeforeunload;window.onbeforeunload=function(event){api.Event.remove(window.parent.document,'click',this.hideContextMenu);if(typeof oldOnBeforeUnload=='function'){return oldOnBeforeUnload(event);}}.bind(this);}if(this.props.mode=='preview'){this.initSortable();}break;case 'select':for(var i=0;i<positions.length;i++){positions[i].classList.remove('hidden');api.Event.add(positions[i],'click',function(event){var target=event.target;while(target&&target.className.indexOf('pa-position')<0&&target.nodeName!='BODY'){target=target.parentNode;}if(!target||target.nodeName=='BODY'){return;}var current=document.querySelector('.pa-position.selected');if(current){current.classList.remove('selected');}target.classList.add('selected');}.bind(this));}if(this.state.selected){var current=document.querySelector('.pa-position[data-position="'+this.state.selected+'"]');if(current){current.classList.add('selected');}}window.changeModulePosition=this.changePosition.bind(this);break;}}.bind(this),100);}.bind(this));},componentWillUnmount:function(){switch(this.props.mode){case 'preview':case 'component':api.Event.remove(document,'click',this.toggleMenu);if(this.props.mode=='preview'){this.deinitSortable();}break;}},initSortable:function(){api.Event.add('.pa-module','mousedown',this.mouseDown);api.Event.add('.pa-module','dragstart',this.dragStart);api.Event.add('.pa-module','dragover',this.dragOver);api.Event.add('.pa-module','dragenter',this.dragOver);api.Event.add('.pa-module','dragend',this.dragEnd);api.Event.add('.position-modules','dragover',this.dragOver);api.Event.add('.position-modules','dragenter',this.dragOver);api.Event.add('.position-modules','drop',this.drop);},deinitSortable:function(){api.Event.remove('.pa-module','mousedown',this.mouseDown);api.Event.remove('.pa-module','dragstart',this.dragStart);api.Event.remove('.pa-module','dragover',this.dragOver);api.Event.remove('.pa-module','dragenter',this.dragOver);api.Event.remove('.pa-module','dragend',this.dragEnd);api.Event.remove('.position-modules','dragover',this.dragOver);api.Event.remove('.position-modules','dragenter',this.dragOver);api.Event.remove('.position-modules','drop',this.drop);},mouseDown:function(event){var target=event.target;var draggable=false;while(target&&target.nodeName!='BODY'){if(target.classList){if(target.classList.contains('sortable-handler')){draggable=true;}else if(target.classList.contains('pa-module')){if(draggable){target.setAttribute('draggable','true');}else{target.removeAttribute('draggable');}return;}}target=target.parentNode;}},dragStart:function(event){var target=event.target;while(target&&target.nodeName!='BODY'){if(target.classList&&target.classList.contains('pa-module')){event.dataTransfer.setData('text',target.getAttribute('data-id'));this.draggedElement=target;return;}target=target.parentNode;}},dragEnd:function(){var placeholder=document.querySelector('.sortable-placeholder');if(placeholder){placeholder.parentNode.removeChild(placeholder);}},dragOver:function(event){var target=event.target;while(target&&target.nodeName!='BODY'){if(target.classList&&(target.classList.contains('pa-module')||target.classList.contains('position-modules'))){break;}target=target.parentNode;}if(!target||target==this.draggedElement||target.nodeName=='BODY'){return;}event.preventDefault();event.stopPropagation();event.dataTransfer.dropEffect='move';var placeholder=document.querySelector('.sortable-placeholder');if(!placeholder){placeholder=document.createElement('div');placeholder.className='sortable-placeholder';}if(target.classList.contains('position-modules')){var isEmpty=true,modules=target.children;for(var i=0;i<modules.length;i++){if(modules[i].classList.contains('pa-module')&&!modules[i].classList.contains('hidden')){isEmpty=false;break;}}if(isEmpty){target.appendChild(placeholder);this.draggedElement.dropTarget=target;}}else{var rect=target.getBoundingClientRect();if(event.clientY-rect.top<rect.bottom-event.clientY){if(!target.previousElementSibling||target.previousElementSibling!=this.draggedElement){target.parentNode.insertBefore(placeholder,target);this.draggedElement.dropTarget=target;}}else if(!target.nextElementSibling){target.parentNode.appendChild(placeholder);this.draggedElement.dropTarget=target.parentNode;}else if(target.nextElementSibling!=this.draggedElement){if(target.nextElementSibling!=placeholder){target.parentNode.insertBefore(placeholder,target.nextElementSibling);this.draggedElement.dropTarget=target.nextElementSibling;}else if(target.nextElementSibling.nextElementSibling){this.draggedElement.dropTarget=target.nextElementSibling.nextElementSibling;}}}},drop:function(event){this.dragEnd();var target=this.draggedElement.dropTarget;var lastParent=this.draggedElement.parentNode;if(target.classList.contains('position-modules')){target.appendChild(this.draggedElement);}else{target.parentNode.insertBefore(this.draggedElement,target);}if(target.classList.contains('position-modules')&&target!=lastParent){event.to=target;event.item=this.draggedElement;this.executeAction(this.config.actions.move,{},event.item,event);}else if(target.parentNode.classList.contains('position-modules')&&target.parentNode!=lastParent){event.to=target.parentNode;event.item=this.draggedElement;this.executeAction(this.config.actions.move,{},event.item,event);}else{event.to=target.classList.contains('position-modules')?target:target.parentNode.parentNode;event.item=this.draggedElement;this.executeAction(this.config.actions.sort,{},event.item,event);}},moveModule:function(type,res,event){if(type=='prepare'){if(typeof event.to=='string'){res.post.batch.position_id=event.to;this.forceReload=true;}else{res.post.batch.position_id=event.to.parentNode.getAttribute('data-position');}res.post.cid=[event.item.getAttribute('data-id')];this.clickedElement=event.item;return res;}if(this.forceReload){delete this.forceReload;return this.refresh(type,res,event);}setTimeout(function(){event=event||{};event.item=this.clickedElement;this.executeAction(this.config.actions.sort,{},event.item,event);}.bind(this),50);return true;},sortModule:function(type,res,event){if(type=='prepare'){res.post.filter.position=event.item.parentNode.parentNode.getAttribute('data-position');var modules=event.item.parentNode.querySelectorAll('li');for(var i=1;i<=modules.length;i++){res.post.order.push(i);}for(var i=0;i<modules.length;i++){res.post.cid.push(modules[i].getAttribute('data-id'));}return res;}return true;},publishModule:function(type,res,event){if(type=='prepare'){return res;}this.clickedElement.setAttribute('data-published','1');return true;},unpublishModule:function(type,res,event){if(type=='prepare'){return res;}this.clickedElement.setAttribute('data-published','0');return true;},trashModule:function(type,res,event){if(type=='prepare'){return res;}this.clickedElement.setAttribute('data-published','-2');return true;},duplicateModule:function(type,res,event){if(type=='prepare'){res.post.cid.push(this.clickedElement.getAttribute('data-id'));return res;}this.refresh(type,res,event);return true;},assignModule:function(type,res,event){if(type=='prepare'){return res;}this.clickedElement.setAttribute('data-assigned','1');return true;},unassignModule:function(type,res,event){if(type=='prepare'){return res;}this.clickedElement.setAttribute('data-assigned','0');return true;},viewPositions:function(type,res,event){if(type=='prepare'){res.href=window.location.href.replace(/&(parent_id=[^&]+|mode=module)/g,'')+'&select-position=1';res.modalButtons=[{text:'close',onClick:function(modal,event){modal.close();}}];return res;}return true;},addModule:function(type,res,event){if(type=='prepare'){res.modalButtons=[{text:'close',onClick:function(modal,event){modal.close();}}];setTimeout(function(){if(this.previewPanel){var update=function(){this.refresh();api.Event.remove(this.previewPanel.props.container.modal,'ModalHidden',update);}.bind(this);api.Event.add(this.previewPanel.props.container.modal,'ModalHidden',update);}}.bind(this),100);return res;}return true;},refresh:function(type,res,event){if(type=='prepare'){return res;}this.setState({loading:true});window.location.reload();return true;},toggleMenu:function(event){var target=event?event.target:null;while(target&&target.nodeName!='BODY'){var found=false;if(target.className&&target.className.match(/pa-(component|module|position)/)){found=true;}if(!found&&target.getAttribute&&target.getAttribute('data-option')!=null){found=true;}if(found){break;}target=target.parentNode;}if(!target||target.nodeName=='BODY'){this.contextMenu.hide();}else if(target.classList.contains('pa-component')){this.showContextMenu('component',event,target);}else if(target.classList.contains('pa-module')){this.showContextMenu('module',event,target);}else if(target.classList.contains('pa-position')){this.showContextMenu('position',event,target);}else{this.showContextMenu('element',event,target);}},showContextMenu:function(type,event,target){this.clickedElement=target;this.contextMenu.setContainerClass(this.config.wrapperClass);var menu=[];if(type=='element'){var scopes=(target.getAttribute('data-scope')||this.config.actions.save.scopes).split(',');for(var type in this.config.optionTypes){if(target.getAttribute('data-'+type)==null){continue;}else if(typeof this.config.optionTypes[type]=='string'&&this.config.contextMenu[this.config.optionTypes[type]]){menu=menu.concat(this.config.contextMenu[this.config.optionTypes[type]]);continue;}if(scopes.length<=1){for(var i=0;i<this.config.optionTypes[type].singleScope.length;i++){var action=JSON.parse(JSON.stringify(this.config.actions.save));action.text=this.config.optionTypes[type].singleScope[i].label;action.condition=this.config.optionTypes[type].singleScope[i].condition;action.optionType=type;action.post.scope='this-page';menu.push(action);}}else{var roots=[];for(var i=0;i<this.config.optionTypes[type].multiScope.length;i++){var root={href:'javascript:void(0)',text:this.config.optionTypes[type].multiScope[i].label,condition:this.config.optionTypes[type].multiScope[i].condition,items:[]};roots.push(root);}for(var i=0;i<roots.length;i++){for(var j=0;j<scopes.length;j++){scopes[j]=scopes[j].trim();var action=JSON.parse(JSON.stringify(this.config.actions.save));action.text=api.Text.parse(scopes[j]);action.optionType=type;action.post.scope=scopes[j];roots[i].items.push(action);}}menu=menu.concat(roots);}}}else if(this.config){menu=this.config.contextMenu[type];}if(menu){var modal=this.previewPanel?this.previewPanel.props.container.modal:null,bounding=this.previewPanel?this.previewPanel.refs.iframe:null;this.contextMenu.show(menu,{},event,this.clickedElement,this,modal,bounding);}},hideContextMenu:function(){api.ContextMenu.hide();},showPositionSelector:function(type,res,event,context,element){if(type=='prepare'){res.href=res.href.replace('{url}',this.previewPanel.state.link);res.href+='&current='+element.parentNode.parentNode.getAttribute('data-position');if(res.href.indexOf('?')<0){res.href=res.href.replace('&','?');}return res;}},changePosition:function(callback){var position=document.querySelector('.pa-position.selected').getAttribute('data-position');var win=this.previewPanel.refs.iframe.contentWindow;elm=win.document.querySelector('.pa-page-preview'),component=elm?win.findReactComponent(elm):null;if(!component){return;}if(this.config.actions.move){var event={};event.item=component.clickedElement;event.from=event.item.parentNode;event.to=position;component.executeAction(this.config.actions.move,{},event.item,event);if(typeof callback=='function'){callback({responseJSON:{success:true}});}}},saveComponentDisplayOption:function(type,res,event){if(type=='prepare'){var paramName=this.clickedElement.getAttribute('data-'+res.optionType),currentValue=parseInt(this.clickedElement.getAttribute('data-'+res.optionType+'-value'));if(isNaN(currentValue)){currentValue=0;}res.post.param=paramName;res.post.value=1-currentValue;this.lastOptionType=res.optionType;return res;}var currentValue=parseInt(this.clickedElement.getAttribute('data-'+this.lastOptionType+'-value')),value;if(isNaN(currentValue)){currentValue=0;}value=1-currentValue;this.clickedElement.setAttribute('data-'+this.lastOptionType+'-value',''+value+'');var elms=document.querySelectorAll('*[data-'+this.lastOptionType+'="'+this.clickedElement.getAttribute('data-'+this.lastOptionType)+'"]');for(var i=0;i<elms.length;i++){if(elms[i]!=this.clickedElement){elms[i].setAttribute('data-'+this.lastOptionType+'-value',value);}}delete this.lastOptionType;return true;}});var ComponentSelectPosition=api.ComponentSelectPosition=api.extendReactClass('MixinBase',{propTypes:{fid:React.PropTypes.string,title:React.PropTypes.string,config:React.PropTypes.string,selector:React.PropTypes.string,wrapperClass:React.PropTypes.string},render:function(){return React.createElement('span',{ref:'mountedDOMNode'},'...');},componentDidMount:function(){api.Event.add(this.refs.mountedDOMNode.parentNode,'click',this.selectPosition);},selectPosition:function(event){event.preventDefault();var menuItemData,assignment=document.getElementById('jform_assignment'),type=assignment.options[assignment.selectedIndex].value,getItemData=function(itemID){if(this.config&&this.config.menus){var menuItem;for(var i=0;i<this.config.menus.length;i++){for(var j=0;j<this.config.menus[i].items.length;j++){if(parseInt(this.config.menus[i].items[j].id)==parseInt(itemID)){menuItem=this.config.menus[i].items[j];break;}}if(menuItem){break;}}}return menuItem;}.bind(this);if(type!='0'&&type!='-'){var items=document.querySelectorAll('input[id^="jform_menuselect"]');for(var i=0;i<items.length;i++){if(items[i].disabled){continue;}if(type=='1'&&items[i].checked||type=='-1'&&!items[i].checked){menuItemData=getItemData(items[i].value);if(menuItemData&&menuItemData.type=='component'&&menuItemData.link!=''){break;}}}}var link=this.props.selector;if(menuItemData&&menuItemData.type=='component'&&menuItemData.link!=''){var query=menuItemData.link.split('?',2)[1];link+=(link.indexOf('?')>-1?'&':'?')+query+'&Itemid='+menuItemData.id;}var field=document.getElementById(this.props.fid),position=field.options[field.selectedIndex].value;if(this.props.wrapperClass){api.Modal.setContainerClass(this.props.wrapperClass);}api.Modal.get({type:'iframe',title:this.props.title,content:{src:link+'&current='+position},width:'90%',height:'90%',confirm:function(modal){var position=modal.refs.iframe.contentWindow.document.querySelector('.pa-position.selected');if(!position){return modal.close();}position=position.getAttribute('data-position');var field=document.getElementById(this.props.fid),options=field.options;for(var i=0;i<options.length;i++){if(options[i].value!=position&&options[i].selected){options[i].selected=false;}else if(options[i].value==position&&!options[i].selected){options[i].selected=true;}}jQuery(field).trigger('liszt:updated');modal.close();}.bind(this)});}});var ComponentTemplateStyles=api.ComponentTemplateStyles=api.extendReactClass('MixinBase',{getInitialState:function(){return{client:'site'};},render:function(){return React.createElement('div',{id:'pa-ts-accordion',ref:'mountedDOMNode'},React.createElement('div',{className:'card'},React.createElement('div',{className:'card-header'},React.createElement('h6',{className:'mb-0'},React.createElement('a',{href:'#installed-templates',onClick:this.toggleAccordion},React.createElement('i',{className:'fa fa-check-circle'}),api.Text.parse('installed-template-styles')))),React.createElement('div',{id:'installed-templates',className:'collapse show',style:{height:'initial'}},React.createElement('div',{className:'card-body'},React.createElement('div',{className:'switch-control'},this.config?function(items){var options=[];for(var client in items){var selected=client==this.state.client?true:false;options.push(React.createElement('option',{value:client,selected:selected},api.Text.parse(client)));}return React.createElement('select',{id:'client-switch',className:'client-switch-box form-control',onChange:this.changeClient},options);}.call(this,this.config.items):null),React.createElement('div',{className:'template-list'},this.config?this.config.items[this.state.client].map((style,index)=>{return React.createElement('div',{className:'template-item'},React.createElement('a',{ref:'style_'+style.id,href:'javascript:void(0)',className:'template-item-thumb'+(style.home=='1'?' active':''),'data-index':index},React.createElement('div',{className:'thumbnail'},style.thumb?React.createElement('img',{src:this.config.root+'/'+style.thumb,alt:style.title,align:'center'}):React.createElement('span',{className:'no-thumb'},api.Text.parse('no-thumb-available'))),React.createElement('h6',{className:'template-item-title'},style.title)));}):null)))),React.createElement('div',{className:'card'},React.createElement('div',{className:'card-header'},React.createElement('h6',{className:'mb-0'},React.createElement('a',{href:'#more-templates',className:'collapsed',onClick:this.toggleAccordion},React.createElement('i',{className:'fa fa-asterisk'}),api.Text.parse('get-more-templates')))),React.createElement('div',{id:'more-templates',className:'collapse'},React.createElement('div',{className:'card-body d-flex justify-content-center'},React.createElement('iframe',{src:'http://www.joomlashine.com/free-joomla-templates-promo.html',width:'640',height:'460'})))));},componentDidMount:function(){this.parent();api.Event.add(document,'click',this.toggleMenu);},componentWillUnmount:function(){this.parent();api.Event.remove(document,'click',this.toggleMenu);},toggleAccordion:function(event){event.preventDefault();var target=this.refs.mountedDOMNode.querySelector(event.target.getAttribute('href'));if(target){var opening=this.refs.mountedDOMNode.querySelector('.collapse.show');if(opening){opening.style.height='initial';opening.style.height=opening.getBoundingClientRect().height+'px';setTimeout(function(){opening.style.height='0px';setTimeout(function(){opening.classList.remove('show');},500);},1);}if(target!=opening){target.classList.add('show');target.style.height='initial';target.style.visibility='hidden';var height=target.getBoundingClientRect().height;target.style.height='0px';target.style.visibility=null;setTimeout(function(){target.style.height=height+'px';},1);}}},toggleMenu:function(event){var target=event?event.target:null;while(target&&target.nodeName!='BODY'){var found=false;for(var p in this.refs){if(this.refs[p]==target){found=true;break;}}if(found){break;}target=target.parentNode;}var hide=false;if(!target||target.nodeName=='BODY'){hide=true;}else if(target.classList&&target.classList.contains('template-item-thumb')){this.showContextMenu('templateStyle',event,target);}else{hide=true;}if(hide){api.ContextMenu.hide();}},showContextMenu:function(type,event,target){this.clickedItem=this.config.items[this.state.client][parseInt(target.getAttribute('data-index'))];this.clickedElement=target.querySelector('.template-item-title');api.ContextMenu.show(this.config.contextMenu[type],this.clickedItem,event,this.clickedElement,this);},addStyleIdToPost:function(type,res,event){if(type=='prepare'){res.post.cid.push(this.clickedItem.id);return res;}},changeClient:function(event){this.setState({client:event.target.options[event.target.selectedIndex].value});}});function renderComponents(){var containers=document.querySelectorAll('[data-render]');for(var i=0;i<containers.length;i++){var ComponentName=containers[i].getAttribute('data-render');eval('ComponentName=typeof '+ComponentName+'!="undefined"?'+ComponentName+':null;');if(ComponentName){var props={},remove=[];for(var j=0;j<containers[i].attributes.length;j++){var attribute=containers[i].attributes[j];if(attribute.name.indexOf('data-')==0){if(attribute.name!='data-render'){props[attribute.name.substr(5)]=attribute.value;}remove.push(attribute.name);}}for(var j=0;j<remove.length;j++){containers[i].removeAttribute(remove[j]);}ReactDOM.render(React.createElement(ComponentName,props),containers[i]);}}api.Edition.init({extension:'com_poweradmin2',callback:function(){this.initJsnPowerAdminSidebarMenuTimeout&&clearTimeout(this.initJsnPowerAdminSidebarMenuTimeout);this.initJsnPowerAdminSidebarMenuTimeout=setTimeout(function(){var item=document.querySelector('ul#submenu a[href*="reset"]');if(item){var badge=item.querySelector('.badge-pro');if(api.isCurrentUserFree('com_poweradmin2')){if(!badge){badge=document.createElement('span');badge.className='badge badge-danger badge-pro';badge.textContent=api.Text.parse('JSN_EXTFW_PRO_BADGE_TEXT',true);item.appendChild(badge);}}else{if(badge){badge.parentNode.removeChild(badge);}}}},100);}});}if(document.readyState=='complete'||document.readyState!='loading'&&!document.documentElement.doScroll){renderComponents();}else{api.Event.add(document,'DOMContentLoaded',renderComponents);}var InputBackendMenu=api.InputBackendMenu=api.extendReactClass('MixinInput',{getInitialState:function(){return{items:null,itemListKey:api.Text.toId('itemList',true)};},componentWillMount:function(){this.parent();this.loadingSortableTimer&&clearTimeout(this.loadingSortableTimer);this.loadingSortableTimer=setTimeout(function(){api.Ajax.loadScript(api.urls.plugin+'/assets/vendors/sortable/html.sortable.min.js',this.forceUpdate.bind(this));}.bind(this),500);},render:function(){var items=this.state.items||(this.config?this.config.items:[]);if(!items.length){return React.createElement(api.ElementLoading,{inline:true});}return React.createElement('div',{ref:'mountedDOMNode',key:this.props.id||api.Text.toId(),className:'form-group '+(this.props.control['class']||this.props.control.className||'')},React.createElement('label',{className:this.props.control.labelClass||''},this.label,this.tooltip),React.createElement('div',{className:this.props.control.inputClass||''},React.createElement('div',{className:'card card-default'},React.createElement('div',{className:'card-header d-flex justify-content-between'},React.createElement('h3',{className:'card-title'},this.label),React.createElement('a',{href:'javascript:void(0)',onClick:this.addGroup},React.createElement('i',{className:'fa fa-plus'}))),React.createElement('div',{className:'card-body'},React.createElement('ul',{id:this.props.id+'_components',key:this.state.itemListKey,ref:'items',className:'item-list'},items.map((item,index)=>{var name=this.props.setting+'['+index+']';return React.createElement('li',{className:'clearfix '+this.props.id+'_components-item','data-title':item.text||item.title,'data-component':item.element||item.title},React.createElement('i',{className:'fa fa-ellipsis-v sortable-handler'+this.props.id+'_components-handler'}),React.createElement('i',{className:'fa fa-ellipsis-v sortable-handler'+this.props.id+'_components-handler'}),item.id?React.createElement('input',{type:'hidden',name:name,value:item.id}):React.createElement('input',{type:'hidden',name:name+'[title]',value:item.title}),item.id?React.createElement('span',{className:'menu-item'},item.text):React.createElement('span',{className:'menu-item',title:api.Text.parse('click-to-edit-group-title'),contentEditable:'true',onKeyDown:this.editGroup.bind(this,index)},item.title),React.createElement('a',{href:'javascript:void(0)',onClick:this.editPermissions,className:'item-action'},React.createElement('i',{className:'fa fa-wrench'})),item.id||item.items&&item.items.length?null:React.createElement('a',{href:'javascript:void(0)',onClick:this.removeGroup.bind(this,index),className:'item-action'},React.createElement('i',{className:'fa fa-trash'})),item.id?null:React.createElement('ul',{id:'group-'+api.Text.toId(item.title),className:'item-list'},item.items&&item.items.length?item.items.map(subItem=>{var subName=name+'[items][]';return React.createElement('li',{className:'clearfix group-'+api.Text.toId(item.title)+'-item','data-title':subItem.text,'data-component':subItem.element},React.createElement('i',{className:'fa fa-ellipsis-v sortable-handler group-'+api.Text.toId(item.title)+'-handler'}),React.createElement('i',{className:'fa fa-ellipsis-v sortable-handler group-'+api.Text.toId(item.title)+'-handler'}),React.createElement('input',{type:'hidden',name:subName,value:subItem.id}),React.createElement('span',{className:'menu-item'},subItem.text),React.createElement('a',{href:'javascript:void(0)',onClick:this.editPermissions,className:'item-action'},React.createElement('i',{className:'fa fa-wrench'})));}):React.createElement('li',{className:'placeholder text-muted'},api.Text.parse('drop-menu-item-here-to-add-to-group'))));}))))));},componentWillUpdate:function(){this.deinitSortable();},componentDidUpdate:function(){this.parent();this.initSortable();},componentWillUnmount:function(){this.parent();this.deinitSortable();},initSortable:function(){if(typeof window.sortable=='function'&&this.refs.mountedDOMNode){var lists=this.refs.mountedDOMNode.querySelectorAll('.item-list');for(var i=0;i<lists.length;i++){var id=lists[i].getAttribute('id');(this.sortable=this.sortable||{})[id]=sortable(lists[i],{connectWith:this.props.id+'_'+this.props.setting,items:'.'+id+'-item',handle:'.'+id+'-handler',forcePlaceholderSize:true});api.Event.add(this.sortable[id][0],'sortupdate',this.handleSort);}}},deinitSortable:function(){if(this.sortable){var lists=this.refs.mountedDOMNode.querySelectorAll('.item-list');for(var i=0;i<lists.length;i++){var id=lists[i].getAttribute('id');if(this.sortable[id]){api.Event.remove(this.sortable[id][0],'sortupdate',this.handleSort);sortable(lists[i],'destroy');}}delete this.sortable;}},handleSort:function(event){if(event.detail.startparent!=event.detail.endparent){var placeholder=event.detail.item.parentNode.querySelector('.placeholder');if(placeholder){event.detail.item.parentNode.removeChild(placeholder);}this.rebuildMenuItems();}else{this.rebuildMenuItems();}},addGroup:function(){var modal=api.Modal.get({type:'html',title:api.Text.parse('add-new-component-menu-group'),content:React.createElement('div',{key:api.Text.toId('new_group_',true),className:'form-group'},React.createElement(api.ElementInput,{type:'text',name:'new_group',value:'',className:'form-control',placeholder:api.Text.parse('new-component-menu-group-hint')})),width:'66%',height:0,centralize:false,onModalShown:function(event){var input=event.target.refs.mountedDOMNode.querySelector('input');if(input){input.focus();}},confirm:function(modal){modal.close();var items=JSON.parse(JSON.stringify(this.state.items||this.config.items));items.unshift({title:modal.refs.mountedDOMNode.querySelector('input').value,items:[]});this.state.items=items;this.state.itemListKey=api.Text.toId('itemList',true);this.triggerChange();}.bind(this)});},editGroup:function(index,event){if(event.keyCode==13){event.preventDefault();var value=event.target.innerHTML.trim();event.target.parentNode.querySelector('input').value=value;(this.state.items||this.config.items)[index].title=value;event.target.blur();this.triggerChange();}else if(event.keyCode==27){event.preventDefault();document.execCommand('undo');event.target.blur();}},removeGroup:function(index,event){var items=JSON.parse(JSON.stringify(this.state.items||this.config.items)),group=items[index];if(group.items&&group.items.length){api.Modal.alert(api.Text.parse('cannot-remove-non-empty-group'));}else{items.splice(index,1);this.state.items=items;this.state.itemListKey=api.Text.toId('itemList',true);this.triggerChange();}},rebuildMenuItems:function(){var items=[],item;for(var i=0;i<this.refs.items.children.length;i++){var input=this.refs.items.children[i].querySelector('input'),subItems=this.refs.items.children[i].querySelectorAll('.item-list>li');if(!subItems.length){if(item=this.getMenuItem(input.value)){input.name=this.props.setting+'['+i+']';items.push(item);}else{items.push({title:input.value,items:[]});}}else{input.name=this.props.setting+'['+i+'][title]';item={title:input.value,items:[]};for(var j=0;j<subItems.length;j++){if(!subItems[j].classList.contains('placeholder')){input=subItems[j].querySelector('input');input.name=this.props.setting+'['+i+'][items][]';item.items.push(this.getMenuItem(input.value));}}items.push(item);}}this.state.items=items;this.state.itemListKey=api.Text.toId('itemList',true);this.triggerChange();},getMenuItem:function(id,items){items=items||this.config.items;var item;for(var i=0;i<items.length;i++){if(id==items[i].id){return items[i];}else if(items[i].items){if(item=this.getMenuItem(id,items[i].items)){return item;}}}},triggerChange:function(){var value=[];this.state.items.map(item=>{if(item.id){value.push(item.id);}else{var items=[];for(var i=0;i<item.items.length;i++){items.push(item.items[i].id);}value.push({items:items,title:item.title});}});this.change(this.props.setting,value);},editPermissions:function(event,force){var target=event.target;while(target&&target.nodeName!='LI'&&target.nodeName!='BODY'){target=target.parentNode;}if(!target||target.nodeName=='BODY'){return;}if(!force&&target.getAttribute('data-component').indexOf('com_')<0){var button=document.querySelector(this.config.saveButton);if(button&&!button.disabled){var item=event.target;return api.Modal.confirm(api.Text.parse('confirm-save-change'),function(modal){jQuery(button).trigger('click');var event={target:item};this.editPermissions(event,true);}.bind(this));}}this.modal=api.Modal.get({type:'iframe',title:this.config.actions.permission.modalTitle.replace('{title}',target.getAttribute('data-title')),content:{src:this.config.actions.permission.href.replace('{component}',target.getAttribute('data-component')),onLoad:function(event){if(target.getAttribute('data-component').indexOf('com_')<0){event.target.contentWindow.jQuery(document).ajaxComplete(function(event,xhr,opts){if(opts.data.indexOf('action=core.view.component.group.')>-1){var components=target.querySelectorAll('li[data-component]');if(components.length){var params=opts.data.split("&"),data={};for(var i=0;i<params.length;i++){var pairs=params[i].split("=");data[pairs[0]]=pairs[1];}(function propagate(i){if(i<components.length){data.comp=data.title=components[i].getAttribute('data-component');data.action='core.manage';api.Ajax.request(opts.url,function(res){setTimeout(function(){propagate(++i);},10);},data);}})(0);}}});}}},width:'90%',height:'90%',buttons:[{text:api.Text.parse('close'),onClick:function(modal){modal.close();}}]});}});var PanelMenu=api.PanelMenu=api.extendReactClass('MixinBase',{propTypes:{mode:React.PropTypes.string,config:React.PropTypes.string,container:React.PropTypes.element},getDefaultProps:function(){return{mode:'list',fitHeight:'.card-body'};},getInitialState:function(){return{showAll:false,selectedMenu:null,selectedItem:null,checkedItems:[],assignTo:'no-page',expanded:[],itemListKey:api.Text.toId('itemList',true)};},configDidLoad:function(){if(!this.config){return;}if(this.state.selectedMenu==null){for(var i=0;i<this.config.menus.length;i++){if(this.config.menus[i].home){return this.selectMenu(i);}}this.selectMenu(0);}},render:function(){var menus=this.config&&this.config.menus?this.config.menus:[];var selectedMenu=menus.length&&this.state.selectedMenu!=null?menus[this.state.selectedMenu]:{items:[]};var contextDropdown=this.config&&this.config.contextMenu?this.config.contextMenu.dropDown:[];var collapsedItems=[];var assignmentOptions=['no-page','all-pages','all-except-selected-page','selected-page'];return React.createElement('div',{ref:'mountedDOMNode',className:'card menu-card'},React.createElement('div',{className:'card-header d-flex justify-content-between'},this.props.mode=='list'?React.createElement('h3',{className:'card-heading-title'},api.Text.parse('menu')):React.createElement('div',{className:'form-inline'},React.createElement('div',{className:'form-group mb-0'},React.createElement('label',{forName:'assign_to'},api.Text.parse('assign-to')),React.createElement('select',{id:'assign_to',name:'assign_to',className:'form-control ml-2',onChange:this.assignTo},assignmentOptions.map(option=>{return React.createElement('option',{value:option,selected:this.state.assignTo==option},api.Text.parse(option));})))),React.createElement('a',{href:'javascript:void(0)',title:api.Text.parse(this.state.showAll?'hide-unpublished-trashed-items':'show-all-items'),onClick:this.toggleShowAll},React.createElement('i',{className:'fa fa-eye',style:{opacity:this.state.showAll?1:0.33}}))),React.createElement('div',{className:'card-body'},api.isCurrentUserFree('com_poweradmin2')&&this.props.mode=='list'?React.createElement(api.ElementBanner,{type:'jsn-poweradmin-2-site-manager-menu-panel',close:function(){api.showIntroduceProModal(api.Text.parse('ETCD9cVv'),api.Text.parse('bB57JAHh'),'com_poweradmin2');},extension:'com_poweradmin2'}):null,React.createElement('div',{className:'menu-card-content'},React.createElement('div',{className:'btn-group'},React.createElement('button',{ref:'selectedMenuType',type:'button',className:'btn btn-default menu-type'},selectedMenu.title||api.Text.parse('no-menu-available'),this.props.mode=='list'?React.createElement('i',{className:'fa fa-pencil float-right edit-icon'}):null),React.createElement('button',{ref:'dropdownToggle',type:'button',className:'btn btn-default dropdown-toggle dropdown-toggle-split'}),React.createElement('ul',{ref:'dropdownMenu',className:'dropdown-menu'},menus.map((menu,index)=>{if(this.state.selected!=index){return React.createElement('li',null,React.createElement('a',{href:'javascript:void(0)',className:'clearfix',onClick:this.selectMenu.bind(this,index)},menu.title,menu.home?React.createElement('i',{className:'fa fa-star'}):null));}}),contextDropdown.map((item,index)=>{if(item.separator){return React.createElement('li',{className:'dropdown-divider'});}var props={href:item.href};if(item.task||item.ajax||item.modal){props.onClick=this.executeAction.bind(this,item,{},this.refs.selectedMenuType);}else if(item.target){props.target=item.target;}return React.createElement('li',{},React.createElement('a',props,item.text));}))),React.createElement('ul',{key:this.state.itemListKey,ref:'items',className:'item-list'},selectedMenu.items.map((item,index)=>{var next=index<selectedMenu.items.length-1?selectedMenu.items[index+1]:null;var collapsed=false;var className=['list-item','clearfix'];if(next&&parseInt(next.level)>parseInt(item.level)){collapsed=this.state.expanded.indexOf(item.id)<0;if(collapsed||collapsedItems.indexOf(item.parent_id)>-1){collapsedItems.push(item.id);}}if(this.state.selectedItem&&item.id==this.state.selectedItem.id){className.push('selected');}if(parseInt(item.published)<1){className.push(parseInt(item.published)==-2?'trashed':'unpublished');}if(!this.state.showAll&&parseInt(item.published)<1||parseInt(item.level)>1&&collapsedItems.indexOf(item.parent_id)>-1){className.push('hidden');}if(this.props.mode!='list'){var checked=false;if(this.state.assignTo=='all-pages'){checked=true;}else if(['all-except-selected-page','selected-page'].indexOf(this.state.assignTo)>-1){checked=this.state.checkedItems.indexOf('-'+item.id)>-1;checked=checked||this.state.checkedItems.indexOf(item.id)>-1;}}return React.createElement('li',{id:'list-item-'+item.id,draggable:'true',className:className.join(' '),'data-index':index,'data-level':item.level},this.props.mode=='list'?React.createElement('i',{className:'fa fa-ellipsis-v sortable-handler'}):React.createElement('label',null,React.createElement('input',{type:'checkbox',name:'items[]',value:item.id,checked:checked,disabled:['no-page','all-pages'].indexOf(this.state.assignTo)>-1,onClick:this.checkItem}),next&&parseInt(next.level)>parseInt(item.level)?React.createElement('a',{href:'javascript:void(0)',className:'toggler',onClick:this.toggleChildren},React.createElement('i',{className:'fa fa-caret-'+(collapsed?'right':'down')})):null,React.createElement('span',{className:'menu-item','data-id':item.id},item.title)),this.props.mode=='list'?[next&&parseInt(next.level)>parseInt(item.level)?React.createElement('a',{href:'javascript:void(0)',className:'toggler',onClick:this.toggleChildren},React.createElement('i',{className:'fa fa-caret-'+(collapsed?'right':'down')})):null,React.createElement('a',{ref:'item_'+item.id,href:'javascript:void(0)',className:'menu-item','data-id':item.id},item.title,parseInt(item.home)?React.createElement('i',{className:'fa fa-star'}):null,item.access!='1'?React.createElement('i',{className:'fa fa-lock'}):null),React.createElement('i',{className:'fa fa-plus float-right'})]:null);})))));},componentDidMount:function(){this.parent();api.Event.add(document,'click',this.toggleMenu);},componentWillUpdate:function(){if(this.props.mode=='list'){this.deinitSortable();}},componentDidUpdate:function(){this.parent();if(this.props.mode!='list'){return;}var menus=this.config&&this.config.menus?this.config.menus:[];var selectedMenu=menus.length&&this.state.selectedMenu!=null?menus[this.state.selectedMenu]:{items:[]};if(!this.state.selectedItem){for(var i=0;i<selectedMenu.items.length;i++){if(selectedMenu.items[i].type=='component'&&selectedMenu.items[i].access=='1'){this.selectItem(i);break;}}}this.initSortable();},componentWillUnmount:function(){this.parent();if(this.props.mode=='list'){this.deinitSortable();}api.Event.remove(document,'click',this.toggleMenu);},initSortable:function(){this.items=this.refs.items.querySelectorAll('.list-item');api.Event.add(this.items,'dragstart',this.dragStart);api.Event.add(this.items,'dragend',this.dragEnd);api.Event.add(this.refs.mountedDOMNode,'dragover',this.dragOver);api.Event.add(this.refs.mountedDOMNode,'dragenter',this.dragOver);api.Event.add(this.refs.mountedDOMNode,'drop',this.drop);},deinitSortable:function(){if(this.items){api.Event.remove(this.items,'dragstart',this.dragStart);api.Event.remove(this.items,'dragend',this.dragEnd);api.Event.remove(this.refs.mountedDOMNode,'dragover',this.dragOver);api.Event.remove(this.refs.mountedDOMNode,'dragenter',this.dragOver);api.Event.remove(this.refs.mountedDOMNode,'drop',this.drop);}},dragStart:function(event){var target=event.target,valid=false;if(Array.prototype.indexOf.call(this.items,target)>-1){valid=true;}else{for(var i=0;i<this.items.length;i++){if(this.items[i].querySelector('.fa-sort')==target){valid=true;target=this.items[i];break;}}}if(!valid){event.preventDefault();event.stopPropagation();}this.draggedElement=target;event.dataTransfer.setData('Text',target.id);},dragEnd:function(event){if(this.placeholder){this.placeholder.style.display='none';}},dragOver:function(event){if(this.placeholder){this.placeholder.style.display='none';}for(var i=0;i<this.items.length;i++){if(this.items[i]==this.draggedElement){continue;}var rect=this.items[i].getBoundingClientRect();if(event.clientY>rect.top&&event.clientY<rect.top+rect.height){this.targetElement=target=this.items[i];event.preventDefault();event.stopPropagation();event.dataTransfer.dropEffect='move';var scrollX=document.body.scrollLeft||document.documentElement.scrollLeft;var scrollY=document.body.scrollTop||document.documentElement.scrollTop;var top;if(event.clientY<rect.top+rect.height/3){var prev=target.previousElementSibling;while(prev&&window.getComputedStyle(prev).getPropertyValue('display')=='none'){prev=prev.previousElementSibling;}if(prev){if(prev!=this.draggedElement){var prevRect=prev.getBoundingClientRect();top=rect.top-(rect.top-(prevRect.top+prevRect.height))/2;}}else{top=rect.top;}this.targetPosition='before';}else if(event.clientY>rect.top+rect.height/3 * 2&&event.clientY<rect.top+rect.height){var next=target.nextElementSibling;while(next&&window.getComputedStyle(next).getPropertyValue('display')=='none'){next=next.nextElementSibling;}if(next){if(next!=this.draggedElement){var nextRect=next.getBoundingClientRect();top=nextRect.top-(nextRect.top-(rect.top+rect.height))/2;}}else{top=rect.top+rect.height;}this.targetPosition='after';}else{this.targetPosition='nested';}for(var i=0;i<target.parentNode.children.length;i++){if(top||target.parentNode.children[i]!=target){target.parentNode.children[i].classList.remove('droppable');}}if(top){if(!this.placeholder){this.placeholder=document.createElement('div');this.placeholder.className='pa-sortable-placeholder';this.placeholder.style.position='absolute';this.placeholder.style.display='none';this.placeholder.style.height='6px';this.placeholder.style.background='rgba(255,255,0,.5)';document.body.appendChild(this.placeholder);}this.placeholder.style.top=scrollY+top-3+'px';this.placeholder.style.left=scrollX+rect.left+'px';this.placeholder.style.width=rect.width+'px';this.placeholder.style.display='block';}else{target.classList.add('droppable');}return;}}},drop:function(event){var index=parseInt(this.draggedElement.getAttribute('data-index'));var item=this.config.menus[this.state.selectedMenu].items[index];if(this.targetPosition=='before'){this.targetElement.parentNode.insertBefore(this.draggedElement,this.targetElement);}else if(target.nextElementSibling){target.parentNode.insertBefore(this.draggedElement,target.nextElementSibling);}else{target.parentNode.appendChild(this.draggedElement);}if(this.targetPosition!='nested'){var next=this.draggedElement.nextElementSibling;var prev=this.draggedElement.previousElementSibling;var prevIsParentAndExpanded;while(next&&next.classList.contains('hidden')){next=next.nextElementSibling;}if(next){index=parseInt(next.getAttribute('data-index'));next=this.config.menus[this.state.selectedMenu].items[index];}while(prev&&prev.classList.contains('hidden')){prev=prev.previousElementSibling;}if(prev){prevIsParentAndExpanded=prev.querySelector('.fa-caret-down');index=parseInt(prev.getAttribute('data-index'));prev=this.config.menus[this.state.selectedMenu].items[index];}if(this.config.actions.update&&(!prev||!next||prev&&prevIsParentAndExpanded&&prev.id!=item.parent_id||next&&prev&&next.parent_id==prev.parent_id&&prev.parent_id!=item.parent_id)){if(!prev||!next){item.parent_id=1;item.menuordering=prev?-2:-1;}else{item.parent_id=prevIsParentAndExpanded?prev.id:prev.parent_id;item.menuordering=prevIsParentAndExpanded?-1:prev.id;}this.executeAction(this.config.actions.update,item,this.draggedElement,event);}else if(this.config.actions.sort){this.executeAction(this.config.actions.sort,item,this.draggedElement,event);}}else{var index=parseInt(this.targetElement.getAttribute('data-index'));var parent=this.config.menus[this.state.selectedMenu].items[index];item.parent_id=parent.id;item.menuordering=-1;this.executeAction(this.config.actions.update,item,this.draggedElement,event);}},toggleShowAll:function(){this.setState({showAll:!this.state.showAll});},toggleMenu:function(event){var target=event?event.target:null;while(target&&target.nodeName!='BODY'){var found=false;for(var p in this.refs){if(this.refs[p]==target||this.refs[p].refs&&this.refs[p].refs.mountedDOMNode&&this.refs[p].refs.mountedDOMNode==target){found=true;break;}}if(found){break;}target=target.parentNode;}var hide=false;if(!target||target.nodeName=='BODY'){hide=true;}else if(target==this.refs.selectedMenuType){if(this.props.mode=='list'){this.showContextMenu('menuType',event,target);}else{if(this.refs.dropdownToggle.parentNode.classList.contains('open')){this.hideDropdownMenu();}else{this.showDropdownMenu();}}}else if(target==this.refs.dropdownToggle){if(this.refs.dropdownToggle.parentNode.classList.contains('open')){this.hideDropdownMenu();}else{this.showDropdownMenu();}}else if(target.classList&&target.classList.contains('menu-item')){if(this.props.mode=='list'){this.showContextMenu('menuItem',event,target);}}else{hide=true;}if(hide){this.hideDropdownMenu();if(this.props.mode=='list'){api.ContextMenu.hide();}}},toggleChildren:function(event){var expanded=this.state.expanded;var current=event.target.parentNode.parentNode;var id=current.querySelector('.menu-item').getAttribute('data-id');var index=expanded.indexOf(id);if(index>-1){expanded.splice(index,1);}else{expanded.push(id);}this.setState({expanded:expanded});},selectMenu:function(index){this.hideDropdownMenu();if(!this.config.menus.length){return;}var state={selectedMenu:index};if(this.props.mode=='list'){var item;for(var i=0;i<this.config.menus[index].items.length;i++){if(parseInt(this.config.menus[index].items[i].home)){item=this.config.menus[index].items[i];break;}}if(!item){for(var i=0;i<this.config.menus[index].items.length;i++){if(this.config.menus[index].items[i].type=='component'&&this.config.menus[index].items[i].access=='1'){item=this.config.menus[index].items[i];}}}if(item){state.selectedItem=item;}}this.setState(state);this.previewItem(item);},deleteMenu:function(type,res,event){if(type=='prepare'){return res;}if(res.responseText.indexOf('<div class="alert-message">')>-1){var items=this.config.menus[this.state.selectedMenu].items;for(var i=0;i<items.length;i++){if(parseInt(items[i].home)||parseInt(items[i].checked_out)){var message=res.responseText.split('<div class="alert-message">')[1].split('</div>')[0];return api.Modal.alert(message);}}}this.config.menus.splice(this.state.selectedMenu,1);this.selectMenu(0);return true;},previewItem:function(item){if(this.props.mode!='list'){return;}if(!item||!item.link||item.type!='component'||item.access!='1'){return;}var link=item.link;if(!link.match(/^(https*:)?\//)){link=this.props.container.config.site+'/'+link;if(!link.match(/\bItemid=\d+\b/)){if(link.indexOf('Itemid=')>-1){link=link.replace('Itemid=','Itemid='+item.id);}else{link+=(link.indexOf('?')<0?'?':'&')+'Itemid='+item.id;}}link+='&poweradmin-preview=1';}this.props.container.setState({link:link});},selectItem:function(){if(this.props.mode!='list'||!this.config){return;}var index=parseInt(arguments.length==1?arguments[0]:this.clickedElement.parentNode.getAttribute('data-index'));var item=this.state.selectedMenu!=null?this.config.menus[this.state.selectedMenu].items[index]:null;if(item&&item.type=='component'&&item.access=='1'){this.setState({selectedItem:item});this.previewItem(item);}},updateItem:function(type,res,event,data){if(type=='prepare'){res.post.jform.type=data.type;res.post.jform.link=data.link;res.post.jform.title=data.title;res.post.jform.request=api.Text.parseQueryString(data.link);res.post.jform.menutype=data.menutype;res.post.jform.language=data.language;res.post.jform.published=data.published;res.post.jform.parent_id=data.parent_id;res.post.jform.menuordering=data.menuordering;return res;}if(parseInt(data.parent_id)>1){this.state.expanded.push(data.parent_id);}if(this.config.actions.sort){this.executeAction(this.config.actions.sort,data,this.refs['item_'+data.id],event);}return true;},sortItem:function(type,res,event){if(type=='prepare'){res.post.menutype=this.config.menus[this.state.selectedMenu].menutype;var items=this.refs.items.querySelectorAll('li');for(var i=1;i<=items.length;i++){res.post.order.push(i);}for(var i=0;i<items.length;i++){var id=this.config.menus[this.state.selectedMenu].items[parseInt(items[i].getAttribute('data-index'))].id;res.post.cid.push(id);}return res;}this.state.itemListKey=api.Text.toId('itemList',true);},publishItem:function(type,res,event){if(type=='prepare'){return res;}for(var i=0;i<this.config.menus[this.state.selectedMenu].items.length;i++){if(this.config.menus[this.state.selectedMenu].items[i].id==this.clickedItem.id){this.config.menus[this.state.selectedMenu].items[i].published='1';break;}}this.forceUpdate();return true;},unpublishItem:function(type,res,event){if(type=='prepare'){return res;}for(var i=0;i<this.config.menus[this.state.selectedMenu].items.length;i++){if(this.config.menus[this.state.selectedMenu].items[i].id==this.clickedItem.id){this.config.menus[this.state.selectedMenu].items[i].published='0';break;}}this.forceUpdate();return true;},checkInItem:function(type,res,event){if(type=='prepare'){return res;}for(var i=0;i<this.config.menus[this.state.selectedMenu].items.length;i++){if(this.config.menus[this.state.selectedMenu].items[i].id==this.clickedItem.id){this.config.menus[this.state.selectedMenu].items[i].checked_out='0';break;}}this.forceUpdate();return true;},trashItem:function(type,res,event){if(type=='prepare'){return res;}for(var i=0;i<this.config.menus[this.state.selectedMenu].items.length;i++){if(this.config.menus[this.state.selectedMenu].items[i].id==this.clickedItem.id){this.config.menus[this.state.selectedMenu].items[i].published='-2';break;}}this.forceUpdate();return true;},executeAction:function(action,context,element,event){event.preventDefault();this.hideDropdownMenu();this.parent(action,context,element,event);},assignTo:function(event){this.setState({assignTo:event.target.options[event.target.selectedIndex].value});},checkItem:function(event){var id=event.target.value;var checkedItems=this.state.checkedItems;var index=checkedItems.indexOf(id);if(index<0&&['all-except-selected-page','selected-page'].indexOf(this.state.assignTo)>-1){index=checkedItems.indexOf('-'+id);}if(event.target.checked&&index<0){checkedItems.push(id);}else if(!event.target.checked&&index>-1){checkedItems.splice(index,1);}this.setState({checkedItems:checkedItems});},showDropdownMenu:function(){api.ContextMenu.hide();this.refs.dropdownToggle.parentNode.classList.add('open');},hideDropdownMenu:function(){this.refs.dropdownToggle.parentNode.classList.remove('open');},showContextMenu:function(type,event,target){this.hideDropdownMenu();if(type=='menuType'){this.clickedItem=this.config.menus[this.state.selectedMenu];this.clickedElement=target;}else{var itemIndex=parseInt(target.parentNode.getAttribute('data-index'));this.clickedItem=this.config.menus[this.state.selectedMenu].items[itemIndex];this.clickedElement=this.refs['item_'+this.clickedItem.id];}api.ContextMenu.show(this.config.contextMenu[type],this.clickedItem,event,this.clickedElement,this,this.props.container.modal);},hasSubMenu:function(){var parent=parseInt(this.clickedElement.getAttribute('data-id'));var hasSub=false;for(var i=0;i<this.config.menus[this.state.selectedMenu].items.length;i++){if(parseInt(this.config.menus[this.state.selectedMenu].items[i].published)&&parseInt(this.config.menus[this.state.selectedMenu].items[i].parent_id)==parent){hasSub=true;break;}}return hasSub;},expandAll:function(type,res,event,item){if(type!='prepare'){return;}var expanded=this.state.expanded;var parents=[item.id];for(var i=0;i<this.config.menus[this.state.selectedMenu].items.length;i++){if(expanded.indexOf(this.config.menus[this.state.selectedMenu].items[i].id)<0){if(parents.indexOf(this.config.menus[this.state.selectedMenu].items[i].parent_id)>-1){parents.push(this.config.menus[this.state.selectedMenu].items[i].id);}if(parents.indexOf(this.config.menus[this.state.selectedMenu].items[i].id)>-1){expanded.push(this.config.menus[this.state.selectedMenu].items[i].id);}}}this.setState({expanded:expanded});},collapseAll:function(type,res,event,item){if(type!='prepare'){return;}var expanded=this.state.expanded;var parents=[item.id];var index;for(var i=0;i<this.config.menus[this.state.selectedMenu].items.length;i++){if((index=expanded.indexOf(this.config.menus[this.state.selectedMenu].items[i].id))>-1){if(parents.indexOf(this.config.menus[this.state.selectedMenu].items[i].parent_id)>-1){parents.push(this.config.menus[this.state.selectedMenu].items[i].id);}if(parents.indexOf(this.config.menus[this.state.selectedMenu].items[i].id)>-1){expanded.splice(index,1);}}}this.setState({expanded:expanded});}});var PanelPreview=api.PanelPreview=api.extendReactClass('MixinBase',{propTypes:{mode:React.PropTypes.string,link:React.PropTypes.string,filters:React.PropTypes.object,container:React.PropTypes.element},getDefaultProps:function(){return{mode:'live',link:null,filters:{'show-empty-position':'.pa-position','show-unassigned-module':'.pa-module[data-assigned="0"]','show-unpublished-module':'.pa-module[data-published="0"]','show-trashed-module':'.pa-module[data-published="-2"]'}};},getInitialState:function(){var state={link:this.props.link,showAll:this.props.mode=='module'?true:false};if(this.props.mode!='component'){for(var filter in this.props.filters){state[filter]=filter=='show-empty-position'?true:false;}}return state;},render:function(){var link=this.state.link||this.props.link;if(link){if(this.props.mode!='component'){for(var filter in this.props.filters){var param='&'+filter+'=1';if(link.indexOf(param)<0){if(this.props.mode=='module'||this.state.showAll&&this.state[filter]){link+=param;}}else{if(this.props.mode=='live'&&(!this.state.showAll||!this.state[filter])){link=link.replace(param,'');}}}if(this.props.mode=='module'){link+='&mode=module';}}else{link+='&tmpl=component';}if(this.lastLink&&link!=this.lastLink&&this.refs.iframe.contentWindow.React&&this.props.container.state.finishedLoading){var elm=this.refs.iframe.contentWindow.document.querySelector('.pa-page-preview'),component=elm?this.refs.iframe.contentWindow.findReactComponent(elm):null;if(component){component.setState({loading:true});}}this.lastLink=link;}return React.createElement('div',{ref:'mountedDOMNode',className:'card '+this.props.mode+'-card'},React.createElement('div',{className:'card-header d-flex justify-content-between'},React.createElement('h3',{className:'card-heading-title'},api.Text.parse(this.props.mode=='live'?'live-view':this.props.mode),'\xA0',this.props.mode=='module'?React.createElement('input',{type:'text',value:this.state.filterByKeyword,className:'blur',placeholder:api.Text.parse('filter'),onChange:this.filterByKeyword,style:{width:'50%'}}):null),this.props.mode!='component'?React.createElement('a',{href:'javascript:void(0)',title:api.Text.parse(this.state.showAll?'clear-display-options':'show-display-options'),onClick:this.toggleShowAll,onMouseOver:this.showFilter,onMouseOut:this.hideFilter},React.createElement('i',{className:'fa fa-eye',style:{opacity:this.state.showAll?1:0.33}})):React.createElement('a',{href:'javascript:void(0)',title:api.Text.parse(this.state.showAll?'hide-invisible-elements':'show-all-elements'),onClick:this.toggleShowAll},React.createElement('i',{className:'fa fa-eye',style:{opacity:this.state.showAll?1:0.33}}))),this.props.mode!='component'?React.createElement('div',{ref:'filter',className:'popover fade bs-popover-bottom hidden',role:'tooltip','x-placement':'bottom',onMouseOut:this.hideFilter},React.createElement('div',{className:'arrow'}),React.createElement('div',{className:'popover-body filter-options'},function(){var filters=[];for(var filter in this.props.filters){filters.push(React.createElement('div',{className:'d-flex pr-4 form-check form-check-inline '+filter},React.createElement('label',{className:'form-check-label'},React.createElement('input',{type:'checkbox',name:filter,checked:this.state[filter],onClick:function(event){if(!this.state.showAll){this.toggleShowAll();}this.filter(event);}.bind(this),className:'form-check-input'}),api.Text.parse(filter))));}return filters;}.bind(this)(),this.props.mode=='live'?React.createElement('div',{className:'form-check form-check-inline'},React.createElement('label',{className:'form-check-label'},React.createElement('input',{type:'checkbox',name:'show-hidden-elements',checked:this.state['show-hidden-elements'],onClick:this.filter,className:'form-check-input'}),api.Text.parse('show-hidden-elements'))):null)):null,React.createElement('div',{className:'card-body'+(this.state.showAll?' filtering':'')},api.isCurrentUserFree('com_poweradmin2')&&this.props.mode!='live'?React.createElement(api.ElementBanner,{type:this.props.mode=='component'?'jsn-poweradmin-2-site-manager-component-panel':'jsn-poweradmin-2-site-manager-module-panel',close:function(){api.showIntroduceProModal(api.Text.parse('ETCD9cVv'),api.Text.parse('bB57JAHh'),'com_poweradmin2');},extension:'com_poweradmin2'}):null,React.createElement('iframe',{ref:'iframe',src:link})));},componentDidMount:function(){this.parent();api.Event.add(this.refs.iframe,'load',this.handleIframeLoad);},componentDidUpdate:function(){this.parent();if(this.props.mode=='component'){var elms=this.refs.iframe.contentWindow.document.querySelectorAll('*[data-visibility-value]');for(var i=0;i<elms.length;i++){var show=this.state.showAll||parseInt(elms[i].getAttribute('data-visibility-value'));elms[i].classList[show?'remove':'add']('hidden');}}else{var filters=JSON.parse(JSON.stringify(this.props.filters));if(this.props.mode=='live'){filters['show-hidden-elements']='*[data-visibility-value=""],*[data-visibility-value="0"]';}else if(this.state.filterByKeyword!==undefined){var tmp={keyword:this.state.filterByKeyword};for(var filter in filters){tmp[filter]=filters[filter];}filters=tmp;}for(var filter in filters){setTimeout(function(filter){var elms;var show=this.state.showAll&&this.state[filter];if(filter=='keyword'){elms=this.refs.iframe.contentWindow.document.querySelectorAll('.pa-module');}else{elms=this.refs.iframe.contentWindow.document.querySelectorAll(filters[filter]);}for(var i=0;i<elms.length;i++){if(filter=='keyword'){var pattern=new RegExp('('+filters[filter]+')','i');elms[i].innerHTML=elms[i].innerHTML.replace(/<span class="highlight">([^<]+)<\/span>/,'$1');if(filters[filter]==''||elms[i].textContent.match(pattern)){if(filters[filter]!=''){var title=elms[i].querySelector('.module-title');title.innerHTML=title.innerHTML.replace(pattern,'<span class="highlight">$1</span>');}elms[i].classList.remove('hidden');}else{elms[i].classList.add('hidden');}}else if(filter=='show-empty-position'){elms[i].classList[this.isPositionEmpty(elms[i])&&!show?'add':'remove']('hidden');}else if(!filters['keyword']||filters['keyword']==''||!elms[i].classList.contains('hidden')){elms[i].classList[show?'remove':'add']('hidden');}}}.bind(this,filter),filter=='show-empty-position'?5:0);}}},componentWillUnmount:function(){this.parent();api.Event.remove(this.refs.iframe,'load',this.handleIframeLoad);},handleIframeLoad:function(event){setTimeout(function(){this.forceUpdate();api.Event.add(this.refs.iframe.contentWindow.document,'click',function(event){var openingDropdowns=document.querySelectorAll('.btn-group.open,.dropdown.open');for(var i=0;i<openingDropdowns.length;i++){openingDropdowns[i].classList.remove('open');}}.bind(this));if(this.props.container&&!this.props.container.state.finishedLoading){this.props.container.setState({finishedLoading:true});}}.bind(this),500);},toggleShowAll:function(){this.setState({showAll:!this.state.showAll});},showFilter:function(event){this.hideFilterTimer&&clearTimeout(this.hideFilterTimer);this.refs.filter.classList.add('show');this.refs.filter.classList.remove('hidden');},hideFilter:function(event){this.hideFilterTimer&&clearTimeout(this.hideFilterTimer);var target=event.relatedTarget;while(target&&target!=this.refs.filter&&target.nodeName!='BODY'){target=target.parentNode;}if(target!=this.refs.filter){this.hideFilterTimer=setTimeout(function(){this.refs.filter.classList.add('hidden');this.refs.filter.classList.remove('show');}.bind(this),1000);}},filter:function(event){var target=event.target.nodeName=='LABEL'?event.target.firstElementChild:event.target;var state={};state[target.name]=target.checked;this.setState(state);},filterByKeyword:function(event){this.setState({filterByKeyword:event.target.value});},isPositionEmpty:function(position){var empty=true,modules=position.querySelectorAll('.pa-module');for(var i=0;i<modules.length;i++){if(!modules[i].classList.contains('hidden')){empty=false;break;}}return empty;},scheduleRefresh:function(timer){setTimeout(function(){this.refs.iframe.contentWindow.location.reload();}.bind(this),timer||3000);}});var ScreenAdminBarSettings=api.ScreenAdminBarSettings=api.extendReactClass('MixinBase',{getDefaultProps:function(){return{id:'',root:'',config:''};},getInitialState:function(){return{data:{},editing:'general'};},render:function(){return React.createElement('div',{ref:'mountedDOMNode'},React.createElement('div',{className:'alert alert-info'},api.Text.parse('JSN_POWERADMIN_CONFIGURATION_ADMIN_BAR_INTRO')),React.createElement('nav',{id:'admin-bar-general',ref:'general',className:'navbar navbar-expand-lg navbar-dark bg-dark mb-4',onMouseOver:this.mouseOver,onMouseOut:this.mouseOut,onClick:this.click},React.createElement('a',{id:'admin-bar-logo',ref:'logo',className:'navbar-brand',href:this.state.data.logo_link,target:this.state.data.logo_target,title:api.Text.parse(this.state.data.logo_slogan),onMouseOver:this.mouseOver,onMouseOut:this.mouseOut,onClick:this.click},this.state.data.logo_file?React.createElement('img',{src:this.props.root+'/'+this.state.data.logo_file}):null),React.createElement('div',{className:'collapse navbar-collapse',style:{height:'100%'}},React.createElement('ul',{className:'navbar-nav mr-auto'},React.createElement('li',{className:'nav-item dropdown'},React.createElement('a',{className:'nav-link dropdown-toggle',href:'#'},'System')),React.createElement('li',{className:'nav-item dropdown'},React.createElement('a',{className:'nav-link dropdown-toggle',href:'#'},'Users')),React.createElement('li',{className:'nav-item dropdown'},React.createElement('a',{className:'nav-link dropdown-toggle',href:'#'},'Menus')),React.createElement('li',{className:'nav-item dropdown'},React.createElement('a',{className:'nav-link dropdown-toggle',href:'#'},'Content')),React.createElement('li',{id:'admin-bar-components',ref:'components',className:'nav-item dropdown',onMouseOver:this.mouseOver,onMouseOut:this.mouseOut,onClick:this.click},React.createElement('a',{className:'nav-link dropdown-toggle',href:'#'},'Components')),React.createElement('li',{className:'nav-item dropdown'},React.createElement('a',{className:'nav-link dropdown-toggle',href:'#'},'Extensions')),React.createElement('li',{className:'nav-item dropdown'},React.createElement('a',{className:'nav-link dropdown-toggle',href:'#'},'Help'))),React.createElement('ul',{className:'navbar-nav navbar-right pa-plugins d-flex align-items-center ml-auto'},React.createElement('li',{className:'nav-item'},React.createElement('a',{className:'nav-link',href:'#'},React.createElement('i',{className:'fa fa-eye'}))),React.createElement('li',{className:'nav-item dropdown'},React.createElement('a',{className:'nav-link',href:'#'},React.createElement('i',{className:'fa fa-desktop'}))),React.createElement('li',{id:'admin-bar-users',ref:'users',className:'nav-item dropdown',onMouseOver:this.mouseOver,onMouseOut:this.mouseOut,onClick:this.click},React.createElement('a',{className:'nav-link',href:'#'},React.createElement('i',{className:'fa fa-user-o'}))),React.createElement('li',{className:'navbar-divider'}),React.createElement('li',{className:'nav-item dropdown'},React.createElement('a',{className:'nav-link',href:'#'},React.createElement('i',{className:'fa fa-star'}))),React.createElement('li',{id:'admin-bar-history',ref:'history',className:'nav-item dropdown',onMouseOver:this.mouseOver,onMouseOut:this.mouseOut,onClick:this.click},React.createElement('a',{className:'nav-link',href:'#'},React.createElement('i',{className:'fa fa-history'}))),React.createElement('li',{id:'admin-bar-spotlight-search',ref:'spotlight-search',className:'nav-item dropdown spotlight-search',onMouseOver:this.mouseOver,onMouseOut:this.mouseOut,onClick:this.click},React.createElement('a',{className:'nav-link',href:'#'},React.createElement('i',{className:'fa fa-search'}),React.createElement('input',{type:'text',placeholder:'search...'}))),React.createElement('li',{className:'navbar-divider'}),React.createElement('li',{className:'nav-item jsn-logo'},React.createElement('a',{className:'nav-link',href:'http://www.joomlashine.com/',target:'_blank'},React.createElement('img',{src:this.props.root+'/plugins/system/jsnextfw/assets/joomlashine/img/logo-jsn.png'})))))),React.createElement(api.ElementForm,{ref:'settings'}));},initActions:function(){if(this.config&&this.config.form){for(var i=0;i<this.config.form.groups.length;i++){this.refs[this.config.form.groups[i].id].classList.remove('editing');if(this.config.form.groups[i].id==this.state.editing){this.refs.settings.setState({rel:this,form:{groups:[{title:this.config.form.groups[i].title,controls:this.config.form.groups[i].controls}]},values:this.state.data});this.refs[this.state.editing].classList.add('editing');}}}},mouseOver:function(event){var target=event.target;while(target&&target.nodeName!='BODY'){for(var p in this.refs){if(this.refs[p]==target){break;}}if(this.refs[p]==target){break;}target=target.parentNode;}if(!target||target.nodeName=='BODY'){return;}event.preventDefault();event.stopPropagation();target.classList.add('hovering');},mouseOut:function(event){var target=event.target;while(target&&target.nodeName!='BODY'){for(var p in this.refs){if(this.refs[p]==target){break;}}if(this.refs[p]==target){break;}target=target.parentNode;}if(!target||target.nodeName=='BODY'){return;}event.preventDefault();event.stopPropagation();target.classList.remove('hovering');},click:function(event){target=event.target;while(target&&target.nodeName!='BODY'){for(var p in this.refs){if(this.refs[p]==target){break;}}if(this.refs[p]==target){break;}target=target.parentNode;}if(!target||target.nodeName=='BODY'){return;}event.preventDefault();event.stopPropagation();this.setState({editing:target.id.replace(/^admin-bar-/,'')});},saveSettings:function(values,event){for(var p in values){this.state.data[p]=values[p];}var form=document.querySelector('#site-manager-pane .form-container');if(form){form=api.findReactComponent(form);if(form){for(var p in this.state.data){form.updateState(p,this.state.data[p]);}}}}});var ScreenSiteManager=api.ScreenSiteManager=api.extendReactClass('MixinBase',{getInitialState:function(){return{link:null,rawMode:true,closedMenuPanel:false,closedModulePanel:false};},componentWillMount:function(){this.parent();this.contextMenu=api.ContextMenu;},render:function(){return React.createElement("div",{ref:"mountedDOMNode",className:"site-manager clearfix"},React.createElement("div",{id:"menu-panel",ref:"menu",className:'float-left'+(this.state.closedMenuPanel?' closed':'')},this.config&&this.config.menu?React.createElement(api.PanelMenu,{config:this.config.menu,container:this}):null,React.createElement("div",{className:"pa-resize-handler horizontal"},React.createElement("a",{href:"javascript:void(0)",className:"pa-close-handler",onClick:this.toggleMenuPanel,title:api.Text.parse(this.state.closedMenuPanel?'open-menu-panel':'close-menu-panel')},React.createElement("i",{className:"fa fa-ellipsis-v"})))),this.state.rawMode?React.createElement("div",{id:"component-panel",ref:"component",className:'float-left'+(this.state.closedModulePanel?' expanded':'')},React.createElement(api.PanelPreview,{mode:"component",link:this.state.link?this.state.link+'&parent_id=component-panel':null,container:this}),React.createElement("div",{className:"pa-resize-handler horizontal"},React.createElement("a",{href:"javascript:void(0)",className:"pa-close-handler",onClick:this.toggleModulePanel,title:api.Text.parse(this.state.closedModulePanel?'open-module-panel':'close-module-panel')},React.createElement("i",{className:"fa fa-ellipsis-v"})))):null,React.createElement("div",{id:"preview-panel",ref:"preview",className:'float-right'+(this.state.rawMode&&this.state.closedModulePanel?' closed':'')},React.createElement(api.PanelPreview,{mode:this.state.rawMode?'module':'live',link:this.state.link?this.state.link+'&parent_id=preview-panel':null,container:this})),this.state.finishedLoading?null:React.createElement(api.ElementLoading,null));},initActions:function(){this.parent();this.modal=this.modal||api.Modal.get({show:false});if(this.config&&this.config.toggleModeBtn&&!this.toggleModeBtn){this.toggleModeBtn=document.querySelector(this.config.toggleModeBtn+' button');if(this.toggleModeBtn&&!this.toggleModeBtn._listenedClickEvent){if(this.toggleModeBtn.getAttribute('onclick')){this.toggleModeBtn.removeAttribute('onclick');}api.Event.add(this.toggleModeBtn,'click',this.toggleMode);this.toggleModeBtn.textContent=api.Text.parse(this.state.rawMode?'switch-to-live-mode':'switch-to-raw-mode');if(api.isCurrentUserFree('com_poweradmin2')){this.toggleModeBtn.innerHTML+='<span class="badge badge-danger badge-pro">'+api.Text.parse('bjSHsjp6',true)+'</span>';}this.toggleModeBtn._listenedClickEvent=true;}}if(this.toggledMode){api.Event.trigger(window,'resize');delete this.toggledMode;}if(this.toggledMenuPanel){var column=this.refs.menu.nextElementSibling;column.style.width=this.calculateColumnWidth(column);delete this.toggledMenuPanel;}if(this.toggledModulePanel){var column=this.refs.preview.previousElementSibling;column.style.width=this.calculateColumnWidth(column);delete this.toggledModulePanel;}},toggleMode:function(){if(api.isCurrentUserFree('com_poweradmin2')){return api.showIntroduceProModal(api.Text.parse('M2e7Vnfb'),api.Text.parse('aCx3hKWy'),'com_poweradmin2');}this.toggledMode=true;this.refs.menu.style.width=null;closedMenuPanel=false;this.refs.menu.style.width=null;this.refs.menu.nextElementSibling.style.width=null;if(this.state.rawMode){this.refs.menu.nextElementSibling.nextElementSibling.style.width=null;if((document.documentElement||document.body).clientWidth<=1440){if(!this.state.closedMenuPanel){closedMenuPanel=true;this.toggledMenuPanel=true;}}}else if(this.state.closedMenuPanel){this.toggledMenuPanel=true;}this.setState({rawMode:!this.state.rawMode,closedMenuPanel:closedMenuPanel,closedModulePanel:false,finishedLoading:false});if(this.toggleModeBtn&&this.toggleModeBtn._listenedClickEvent){this.toggleModeBtn.textContent=api.Text.parse(this.state.rawMode?'switch-to-live-mode':'switch-to-raw-mode');}},toggleMenuPanel:function(){this.toggledMenuPanel=true;this.setState({closedMenuPanel:!this.state.closedMenuPanel});},toggleModulePanel:function(){this.toggledModulePanel=true;this.setState({closedModulePanel:!this.state.closedModulePanel});},calculateColumnWidth:function(column,prevWidth){var totalWidth=parseInt(window.getComputedStyle(column.parentNode).getPropertyValue('width'));var columns=column.parentNode.children;var width=totalWidth;for(var i=0;i<columns.length;i++){if(columns[i].classList.contains('pa-loading-mask')){continue;}if(columns[i]==column.previousElementSibling){width-=prevWidth||parseInt(window.getComputedStyle(columns[i]).getPropertyValue('width'));}else if(columns[i]!=column){width-=parseInt(window.getComputedStyle(columns[i]).getPropertyValue('width'));}}width=Math.round(width/totalWidth * 100);return width+'%';}});var ScreenSiteSearch=api.ScreenSiteSearch=api.extendReactClass('MixinBase',{getInitialState:function(){return{keyword:this.props.keyword,coverage:this.props.coverage,listLimit:20};},componentWillMount:function(){this.parent();if(this.props.keyword!=''){this.lastKeyword=this.props.keyword;}if(this.props.coverage!=''){this.lastCoverage=this.props.coverage;}},render:function(){if(!this.config||!this.config.coverages){return React.createElement(api.ElementLoading,{inline:true});}if(!this.lastKeyword){this.lastKeyword='';}if(!this.lastCoverage){for(var p in this.config.coverages){this.lastCoverage=p;break;}}var page=this.config.coverages[this.lastCoverage].page;if(this.lastCoverage&&this.config.coverages[this.lastCoverage]){page+='&'+this.config.coverages[this.lastCoverage].name+'='+this.lastKeyword;page+='&list[limit]='+this.state.listLimit;page+='&poweradmin-search=1';}return React.createElement('div',{ref:'mountedDOMNode',className:'pa-search-filter'},React.createElement('div',{className:'js-stools clearfix'},React.createElement('div',{className:'clearfix'},React.createElement('div',{className:'js-stools-container-bar'},React.createElement('div',{className:'btn-wrapper input-append'},React.createElement('input',{ref:'keyword',type:'text',value:this.state.keyword,placeholder:api.Text.parse('search'),onChange:function(event){this.setState({keyword:event.target.value});}.bind(this)}),React.createElement('button',{ref:'search',type:'button',className:'btn',onClick:this.search},React.createElement('span',{className:'icon-search'}))),React.createElement('div',{className:'btn-wrapper'},React.createElement('select',{ref:'coverage',onChange:function(event){this.state.coverage=event.target.options[event.target.selectedIndex].value;this.search();}.bind(this)},this.config.coverages?function(){var coverages=[];for(var p in this.config.coverages){coverages.push(React.createElement('option',{value:p,selected:p==this.state.coverage?true:false},this.config.coverages[p].text));}return coverages;}.bind(this)():null)),React.createElement('div',{className:'btn-wrapper'},React.createElement('button',{type:'button',className:'btn js-stools-btn-clear',onClick:function(){this.state.keyword='';this.state.coverage='';this.search();}.bind(this)},api.Text.parse('clear')))),React.createElement('div',{className:'js-stools-container-list hidden-phone hidden-tablet shown'},React.createElement('div',{className:'ordering-select hidden-phone'},React.createElement('div',{className:'js-stools-field-list'},React.createElement('select',{id:'list_limit',name:'list[limit]',className:'input-mini',onChange:function(event){this.setState({listLimit:event.target.options[event.target.selectedIndex].value});}.bind(this)},[5,10,15,20,25,30,50,100,200,500,0].map(limit=>{return React.createElement('option',{value:limit,selected:limit==this.state.listLimit?true:false},limit==0?api.Text.parse('all'):limit);}))))))),React.createElement('iframe',{ref:'results',src:page,className:'pa-search-result mt-3',onLoad:this.finish}));},componentDidUpdate:function(){this.parent();if(this.refs.mountedDOMNode&&!this.form){this.form=this.refs.mountedDOMNode;while(this.form&&this.form.nodeName!='FORM'&&this.form.nodeName!='BODY'){this.form=this.form.parentNode;}if(this.form.nodeName=='FORM'){api.Event.add(this.form,'submit',this.search);}}},componentWillUnmount:function(){this.parent();if(this.form.nodeName=='FORM'){api.Event.remove(this.form,'submit',this.search);}},search:function(event){if(event){event.preventDefault();event.stopPropagation();}if(this.state.coverage==''){for(var p in this.config.coverages){this.state.coverage=p;break;}}if(this.lastKeyword!=this.state.keyword||this.lastCoverage!=this.state.coverage){this.refs.search.origHTML=this.refs.search.origHTML||this.refs.search.innerHTML;this.refs.search.innerHTML='<i class="fa fa-circle-o-notch fa-spin"></i>';this.lastKeyword=this.state.keyword;this.lastCoverage=this.state.coverage;this.forceUpdate();}},finish:function(){this.refs.search.innerHTML=this.refs.search.origHTML||this.refs.search.innerHTML;var form=this.refs.results.contentWindow.document.querySelector('form');if(form){form.action=this.config.coverages[this.lastCoverage].page+'&poweradmin-search=1';}var links=this.refs.results.contentWindow.document.querySelectorAll('a');for(var i=0;i<links.length;i++){links[i].target='_blank';}}});})((JSN=window.JSN||{}));